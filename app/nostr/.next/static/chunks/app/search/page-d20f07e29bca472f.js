(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{5856:function(){},4884:function(e,t,n){Promise.resolve().then(n.bind(n,4809))},9881:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return i}});var r=n(9268),s=n(6008),l=n(6006);function i(e){let{initialValue:t}=e,n=(0,s.useRouter)(),[i,a]=(0,l.useState)(t),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{var e;null===(e=c.current)||void 0===e||e.focus()},[]),(0,l.useEffect)(()=>{a(t)},[t]),(0,r.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),""===i){n.push("/");return}let t=new URLSearchParams;t.set("q",i),n.push("./search?"+t.toString())},children:(0,r.jsx)("input",{type:"text",ref:c,placeholder:"What are you looking for?",className:"input input-bordered w-full",value:i,onChange:e=>a(e.target.value)})})}},4809:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});var r=n(9268),s=n(6006),l=n(9881),i=n(1691);let a=e=>{let{pubkeyUri:t,profile:n}=e;return(0,r.jsx)("div",{className:"avatar placeholder",children:(0,r.jsx)("div",{className:"w-14 h-14 rounded"+(n?"":" bg-slate-200"),children:(0,r.jsx)("a",{href:t,children:(null==n?void 0:n.properties.picture)&&(0,r.jsx)("img",{src:null==n?void 0:n.properties.picture,alt:n.properties.displayName,className:n?"":"animate-pulse"})})})})};var c=n(38),o=n(7363),u=n(8471),d=n(1333),m=n(7326),h=n.n(m),f=n(4318),p=n(7218);f.zR("nostr",!0);let x={target:"_blank",rel:"noopener noreferrer",nl2br:!0,format:(e,t)=>{if("url"===t){let t=e.match(/^nostr:((?:npub|note|nprofile|nevent|nrelay|naddr)1)(.+)$/);if(t&&t[2].length>14)return t[1]+t[2].slice(0,7)+":"+t[2].slice(t[2].length-7)}return e},validate:(e,t)=>!!("url"===t&&(e.startsWith("http")||e.startsWith("nostr:")))};h().addHook("afterSanitizeAttributes",function(e){if("A"===e.tagName){let t=e.getAttribute("href");t&&!t.startsWith("nostr:")&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener"))}});let v=e=>{var t;let{note:n,onClick:s}=e,l=(t=n.content,(0,p.Z)(t,x));return(0,r.jsx)("div",{className:"cursor-pointer prose-a:text-primary",onClick:s,dangerouslySetInnerHTML:{__html:l}})},b=e=>{let{note:t,onNoteBodyClick:n}=e,[l,i]=(0,s.useState)(!1),a=t.content.length>256;return a?l?(0,r.jsxs)("div",{children:[(0,r.jsx)(v,{note:t,onClick:n}),(0,r.jsx)("div",{className:"mt-2 w-full",children:(0,r.jsx)("button",{className:"link link-primary btn-link",onClick:()=>i(!1),children:"Show less"})})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{onClick:n,className:"cursor-pointer",children:l?t.content:t.content.slice(0,256)+"..."}),(0,r.jsx)("div",{className:"mt-2 w-full",children:(0,r.jsx)("button",{className:"link link-primary btn-link",onClick:()=>i(!0),children:"Show more"})})]}):(0,r.jsx)(v,{note:t,onClick:n})};var j=n(5999);let g=e=>{let{note:t,children:n}=e,[l,i]=(0,s.useState)(!1),a=t.tags.find(e=>"content-warning"===e[0]);if(a){let e=a?a[1]:"";if(!l)return(0,r.jsx)("p",{children:(0,r.jsxs)("button",{className:"btn btn-outline btn-warn",onClick:()=>i(!0),children:["Content warning (Reason: ",e,")"]})})}return(0,r.jsx)(r.Fragment,{children:n})};var k=n(2801);let y=e=>{let{text:t,title:n}=e,[l,i]=(0,s.useState)(!1),a=()=>{navigator.clipboard.writeText(t),i(!0),setTimeout(()=>i(!1),1e3)};return l?(0,r.jsx)("span",{className:"btn btn-primary btn-ghost btn-xs text-success",title:n,onClick:a,children:(0,r.jsx)(k.l_A,{})}):(0,r.jsx)("span",{className:"btn btn-primary btn-ghost btn-xs",title:n,onClick:a,children:(0,r.jsx)(k.esY,{})})},N=e=>{let{note:t}=e,n=(0,i.useApp)(),[l,m]=(0,s.useState)();(0,s.useEffect)(()=>{n.aps.get(t.pubkey).then(e=>e&&m(e))},[n.aps,t.pubkey]);let h=new Date(1e3*t.created_at),f=(0,j.Ps)("npub",t.pubkey),p=(0,j.Ps)("note",t.id),x="nostr:"+f,v="nostr:"+p;return(0,r.jsx)("div",{className:"card card-bordered shadow-lg my-3",children:(0,r.jsxs)("div",{className:"card-body break-all p-5",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(a,{pubkeyUri:x,profile:l}),(0,r.jsxs)("div",{className:"flex flex-col w-full gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row items-top",children:[(0,r.jsx)("div",{className:"flex-none text-sm",children:(0,r.jsx)("a",{href:x,children:!l&&(0,r.jsx)("div",{className:"my-2 h-2 w-32 bg-slate-200 rounded animate-pulse"})})}),(0,r.jsxs)("div",{className:"flex-1 mr-4",children:[(0,r.jsxs)("a",{href:x,children:[(0,r.jsx)("strong",{children:null==l?void 0:l.properties.displayName})," ",(null==l?void 0:l.properties.name)&&"@"+(null==l?void 0:l.properties.name)]}),(0,r.jsx)("span",{className:"ml-1",children:f&&(0,r.jsx)(y,{text:f,title:"Copy author npub"})})]}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{title:h.toISOString(),className:"text-sm flex-none",children:function(e,t){let n=(0,o.Z)(t,e);return n<60?"<1m":n<3600?(0,c.Z)(t,e)+"m":(0,d.Z)(t,e)?(0,u.Z)(e,"HH:mm"):(0,u.Z)(e,"yyyy-MM-dd")}(h,n.currentTime)})})]}),(0,r.jsx)(g,{note:t,children:(0,r.jsx)(b,{note:t,onNoteBodyClick:e=>{e.target instanceof HTMLAnchorElement||window.location.replace(v)}})})]})]}),(0,r.jsx)("div",{className:"text-right",children:p&&(0,r.jsx)(y,{text:p,title:"Copy note Id"})})]})},t.id)};var w=n(6008);let C=(e,t)=>{let n=Object.values(e).sort((e,t)=>e.created_at-t.created_at);for(let r=0;r<n.length-t;r++)delete e[n[r].id]};function S(e){return e.normalize("NFKC").toLowerCase()}function _(){let e=(0,i.useApp)(),t=(0,w.useSearchParams)(),n=t.get("q")||"",a=(0,s.useMemo)(()=>S(n).split(/\s+/),[n]),[c,o]=(0,s.useState)(!1),[u,d]=(0,s.useState)({}),m=(0,s.useRef)(""),h=(0,s.useCallback)(e=>{e.length>0&&o(!0),d(t=>{let n={...t};for(let t of e){let e=t.received.event,r=S(e.content);a.every(e=>r.includes(e))&&(n[e.id]=e)}return C(n,5e3),n})},[a]),f=(0,s.useCallback)((e,t)=>e.subscribe({filters:[{kinds:[1],search:t,limit:100}],onEvent:h,onRecovered:e=>(console.log("relay(".concat(e.url,") was added or recovered. It joins subscription")),[{kinds:[1],search:t,limit:100,until:Math.floor(Date.now()/1e3)}])}),[h]);(0,s.useEffect)(()=>{d({}),n&&e.mux&&(m.current&&e.mux.unSubscribe(m.current),m.current=f(e.mux,n))},[e.mux,n,f]);let p=Object.values(u).sort((e,t)=>t.created_at-e.created_at);return(0,r.jsxs)("div",{className:"container mx-auto mt-5 px-2",children:[(0,r.jsx)(l.default,{initialValue:n}),(0,r.jsx)("div",{className:"mt-8",children:n&&(0,r.jsxs)("div",{className:"flex align-middle",children:[(0,r.jsxs)("div",{children:["Search for ",(0,r.jsx)("strong",{children:n})," (",p.length," hits)"]}),(0,r.jsx)("div",{className:"relative flex h-3 w-3 ml-2 my-auto",children:(0,r.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-primary opacity-75"})})]})}),(0,r.jsx)("div",{className:"mt-2",children:p.map(e=>(0,r.jsx)(N,{note:e},e.id))}),n&&c&&p.length<5e3&&(0,r.jsx)("button",{className:"my-5 link link-primary",onClick:function(){var t;if(o(!1),0===p.length)return;let r=p[p.length-1].created_at;0===r&&(r=1);let s=null===(t=e.mux)||void 0===t?void 0:t.subscribe({filters:[{kinds:[1],search:n,limit:100,until:r}],onEvent:h,onEose(){e.mux.unSubscribe(s)}});setTimeout(()=>{e.mux.unSubscribe(s)},1e4)},children:"More"})]})}},1691:function(e,t,n){"use strict";n.r(t),n.d(t,{App:function(){return o},AppProvider:function(){return d},useApp:function(){return u}});var r=n(9268),s=n(2900),l=n(6006);let i=[..."wss://search.nos.today,wss://relay.nostr.band,wss://relay.noswhere.com".split(",")||[],..."wss://relay.damus.io,wss://nos.lol".split(",")||[]],a=new s.vh,c=new s.wU({parser:s.up,autoEvict:!1,collectPubkeyFromEvent:(e,t)=>t&&(1===e.kind||42===e.kind)?[e.pubkey]:[]});a.installPlugin(c);let o=(0,l.createContext)({mux:a,aps:c,currentTime:new Date});function u(){return(0,l.useContext)(o)}function d(e){let{children:t}=e,[n,u]=(0,l.useState)(new Date);return(0,l.useEffect)(()=>{let e=setInterval(()=>{u(new Date)},1e4);return()=>{clearInterval(e)}},[]),(0,l.useEffect)(()=>{for(let e of i)a.addRelay(new s.ZD(e))},[]),(0,r.jsx)(o.Provider,{value:{mux:a,aps:c,currentTime:n},children:t})}}},function(e){e.O(0,[296,801,418,253,961,744],function(){return e(e.s=4884)}),_N_E=e.O()}]);