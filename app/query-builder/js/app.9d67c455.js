(function(e){function t(t){for(var n,o,u=t[0],s=t[1],l=t[2],d=0,p=[];d<u.length;d++)o=u[d],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);c&&c(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,u=1;u<r.length;u++){var s=r[u];0!==i[s]&&(n=!1)}n&&(a.splice(t--,1),e=o(o.s=r[0]))}return e}var n={},i={app:0},a=[];function o(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=n,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var c=s;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},"005a":function(e,t,r){"use strict";r("e343")},"01f7":function(e,t,r){},"06c6":function(e,t,r){"use strict";r("a08d")},"09f9":function(e,t,r){},1:function(e,t){},"18b8":function(e,t,r){"use strict";r("f643")},2:function(e,t){},"2a86":function(e,t,r){},"3af9":function(e,t,r){},"3df0":function(e,t,r){"use strict";r("2a86")},"43c8":function(e,t,r){"use strict";r("09f9")},"4a2b":function(e,t,r){},"53d7":function(e,t,r){"use strict";r("01f7")},"5c33":function(e,t,r){"use strict";r("65da")},"616c":function(e,t,r){"use strict";r("b286")},"65da":function(e,t,r){},7105:function(e,t,r){},"7c0f":function(e,t,r){"use strict";r("4a2b")},a08d:function(e,t,r){},b067:function(e,t,r){"use strict";r("3af9")},b286:function(e,t,r){},c144:function(e,t,r){},c8be:function(e,t,r){"use strict";r("7105")},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app",lang:e.lang,dir:e.textDirection}},[e.isi18nLoaded?r("QueryBuilder"):e._e()],1)},a=[],o=(r("d3b7"),r("ac1f"),r("3ca3"),r("841c"),r("ddb0"),r("2b3d"),r("96cf"),r("1da1")),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder"},[r("main",[r("h1",{staticClass:"querybuilder__heading"},[r("bdi",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-heading"},expression:"{msg: 'query-builder-heading'}"}],attrs:{id:"directionSample"}})]),r("p",{staticClass:"querybuilder__description",domProps:{innerHTML:e._s(e.$i18n("query-builder-intro-text","https://www.wikidata.org/wiki/Special:MyLanguage/Wikidata:SPARQL_tutorial","https://www.wikidata.org/wiki/Wikidata_talk:Query_Builder"))}}),r("div",{attrs:{role:"form"}},[r("h2",{staticClass:"querybuilder__query-title",domProps:{innerHTML:e._s(e.$i18n("query-builder-query-heading"))}}),r("p",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-find-all-items"},expression:"{msg: 'query-builder-find-all-items'}"}],staticClass:"querybuilder__query-subtitle"}),e.conditionRows.length?e._e():r("div",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-condition-placeholder"},expression:"{msg: 'query-builder-condition-placeholder'}"}],staticClass:"querybuilder__condition-placeholder"}),e._l(e.conditionRows,(function(t,n){return r("div",{key:t.conditionId,class:["querybuilder__condition-group",e.isAboveOr(n)?"querybuilder__condition-group--above":""]},[r("div",{class:["querybuilder__condition-wrapper",0==n?"querybuilder__condition-wrapper--first":"",n+1==e.conditionRows.length?"querybuilder__condition-wrapper--last":"",e.isBelowOr(n)?"querybuilder__condition-wrapper--below":"",e.isAboveOr(n)?"querybuilder__condition-wrapper--above":""]},[r("QueryCondition",{attrs:{"condition-index":n}})],1),n+1!==e.conditionRows.length?r("ConditionRelationToggle",{class:["querybuilder__condition-relation-toggle",e.isBelowOr(n+1)?"querybuilder__condition-relation-toggle-or":""],attrs:{value:e.conditionRows[n+1].conditionRelation},on:{"set-relation-toggle":function(t){return e.setConditionRelation(t,n)}}}):e._e()],1)})),r("AddCondition",{on:{"add-condition":e.addCondition}}),r("h2",{staticClass:"querybuilder__setting-header",domProps:{innerHTML:e._s(e.$i18n("query-builder-settings-heading"))}}),r("div",{staticClass:"querybuilder__settings"},[r("Limit"),r("LabelOptout")],1),r("div",{staticClass:"querybuilder__run"},[r("Button",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-run-query"},expression:"{msg: 'query-builder-run-query'}"}],attrs:{type:"progressive",variant:"primary"},nativeOn:{click:function(t){return e.runQuery(t)}}}),r("SharableLink")],1)],2),r("QueryResult",{attrs:{encodedQuery:e.encodedQuery,iframeRenderKey:e.iframeRenderKey}})],1),r("div",{staticClass:"query-builder__footer"},[r("Footer")],1)])},s=[],l=(r("5319"),r("5530")),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("footer",{staticClass:"querybuilder-footer"},[r("div",{staticClass:"querybuilder-footer__column"},[r("h2",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-about-query-builder"},expression:"{msg: 'query-builder-footer-about-query-builder'}"}],staticClass:"querybuilder-footer__title"}),r("p",{domProps:{innerHTML:e._s(e.$i18n("query-builder-footer-licence",e.license))}}),e.buildTime&&e.commitLink?r("p",{staticClass:"querybuilder-footer__build-info",domProps:{innerHTML:e._s(e.$i18n("query-builder-footer-build-time",e.commitLink,e.buildTime))}}):e._e(),r("p",[r("a",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-view-source"},expression:"{msg: 'query-builder-footer-view-source'}"}],attrs:{href:"https://gerrit.wikimedia.org/g/wikidata/query-builder"}})]),r("p",{staticClass:"querybuilder-footer__report-link"},[r("a",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-report-link"},expression:"{msg: 'query-builder-footer-report-link'}"}],attrs:{href:e.bugLink}})])]),r("div",{staticClass:"querybuilder-footer__column"},[r("h2",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-about-us"},expression:"{msg: 'query-builder-footer-about-us'}"}],staticClass:"querybuilder-footer__title"}),e.privacyPolicy?r("p",{staticClass:"querybuilder-footer__privacy-policy"},[r("a",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-privacy-policy"},expression:"{msg: 'query-builder-footer-privacy-policy'}"}],attrs:{href:e.privacyPolicy}})]):e._e(),r("p",[r("a",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-wikimedia-deutchland"},expression:"{msg: 'query-builder-footer-wikimedia-deutchland'}"}],attrs:{href:"https://www.wikimedia.de/"}})]),r("p",[r("a",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-footer-team"},expression:"{msg: 'query-builder-footer-team'}"}],attrs:{href:"https://www.wikidata.org/wiki/Wikidata:Contact_the_development_team"}})])])])},d=[],p=(r("4160"),r("159b"),r("d4ec")),h=r("bee2"),m=function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"serialize",value:function(e){var t=this,r=[];return e.conditionRows.forEach((function(e){r.push({propertyId:e.propertyData.isPropertySet?e.propertyData.id:"",propertyDataType:e.propertyData.datatype,propertyValueRelation:e.propertyValueRelationData.value,referenceRelation:e.referenceRelation,value:t.getValueFromCondition(e),subclasses:e.subclasses,conditionRelation:e.conditionRelation,negate:e.negate})})),JSON.stringify({conditions:r,limit:e.limit,useLimit:e.useLimit,omitLabels:e.omitLabels})}},{key:"getValueFromCondition",value:function(e){if(!e.valueData.value)return"";if("wikibase-item"===e.propertyData.datatype)return e.valueData.value.id;if("quantity"===e.propertyData.datatype){var t=e.valueData.value;return{value:t.value,unit:t.unit?t.unit.id:null}}if("time"===e.propertyData.datatype){var r=e.valueData.value;return r.parseResult?{value:r.parseResult.value.time,precision:r.parseResult.value.precision}:""}return e.valueData.value}}]),e}(),y=n["default"].extend({name:"Footer",data:function(){return{license:"https://gerrit.wikimedia.org/r/plugins/gitiles/wikidata/query-builder/+/refs/heads/master/LICENSE"}},computed:{buildTime:function(){var e=new Date;return e.setTime(parseInt("1623846032766")),e.toUTCString()},commitLink:function(){var e="62d049b76cf2533886d6294e9df0e5e1a37880db";return!!e&&"https://gerrit.wikimedia.org/g/wikidata/query-builder/+/".concat(e)},bugLink:function(){var e=new m,t=e.serialize(this.$store.state),r=new URL(window.location.href);r.searchParams.set("query",t);var n="Wikidata%20Query%20Builder+Ticket+Template",i="**Problem:**\n\n**Example:**\n\n**Screenshots:**\n\n**Link+to+query:**\n",a="https://phabricator.wikimedia.org/maniphest/task/edit/form/1/?title=";return a+n+"&description="+encodeURI(i+r.href)+"&projects=Wikidata_Query_Builder"},privacyPolicy:function(){return"https://wikitech.wikimedia.org/wiki/Wikitech:Cloud_Services_Terms_of_use"}}}),f=y,b=(r("53d7"),r("2877")),v=Object(b["a"])(f,c,d,!1,null,null,null),g=v.exports,w=r("2f62"),x=r("5b80"),k=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ToggleButtonGroup",{staticClass:"conditionRelationToggle",attrs:{value:e.value},on:{input:function(t){return e.$emit("set-relation-toggle",t)}},scopedSlots:e._u([{key:"default",fn:function(){return[r("ToggleButton",{attrs:{value:"and"}},[e._v(e._s(e.$i18n("query-builder-condition-relation-toggle-and")))]),r("ToggleButton",{attrs:{value:"or"}},[e._v(e._s(e.$i18n("query-builder-condition-relation-toggle-or")))])]},proxy:!0}])})},R=[],T=n["default"].extend({name:"ConditionRelationToggle",components:{ToggleButton:x["ToggleButton"],ToggleButtonGroup:x["ToggleButtonGroup"]},props:{value:{type:String,default:"add"}}}),I=T,O=Object(b["a"])(I,k,R,!1,null,null,null),V=O.exports,q=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-condition"},[r("NegationToggle",{staticClass:"query-condition__toggle-button-group",model:{value:e.negateValue,callback:function(t){e.negateValue=t},expression:"negateValue"}}),r("div",{staticClass:"query-condition__input-container"},[r("div",[r("PropertyLookup",{staticClass:"query-condition__property-lookup",attrs:{error:e.propertyError(e.conditionIndex)},model:{value:e.selectedProperty,callback:function(t){e.selectedProperty=t},expression:"selectedProperty"}})],1),r("div",[r("ValueTypeDropDown",{staticClass:"query-condition__value-type-dropdown",attrs:{disabled:e.limitedSupport(e.conditionIndex),datatype:e.datatype},model:{value:e.selectedPropertyValueRelation,callback:function(t){e.selectedPropertyValueRelation=t},expression:"selectedPropertyValueRelation"}})],1),r("div",[r("ValueInput",{staticClass:"query-condition__value-input",attrs:{disabled:e.isValueInputDisabled(),error:e.valueError,datatype:e.datatype},model:{value:e.conditionValue,callback:function(t){e.conditionValue=t},expression:"conditionValue"}}),e.isSubclassCheckboxVisible?r("SubclassCheckbox",{attrs:{disabled:e.isValueInputDisabled(),isChecked:e.subclasses(e.conditionIndex)},on:{"subclass-check":e.setSubclasses}}):e._e()],1),r("div",[r("ReferenceRelationDropDown",{staticClass:"query-condition__references",model:{value:e.selectedReferenceRelation,callback:function(t){e.selectedReferenceRelation=t},expression:"selectedReferenceRelation"}})],1)]),r("DeleteConditionButton",{staticClass:"query-condition__remove",on:{click:e.removeCondition}})],1)},_=[],P=(r("a9e3"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(e.dispatchComponent,{tag:"component",attrs:{value:e.value,disabled:e.disabled,error:e.error},on:{input:function(t){return e.$emit("input",t)}}})}),C=[],j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("EntityLookup",{attrs:{value:e.value,error:e.error,searchForMenuItems:e.searchForItems,label:e.$i18n("query-builder-input-value-label"),tooltip:e.$i18n("query-builder-input-value-tooltip"),placeholder:e.$i18n("query-builder-input-value-placeholder"),"no-match-found-message":e.$i18n("query-builder-item-value-lookup-no-match-found"),disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}}})},B=[],E=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Lookup",{attrs:{value:e.value,error:e.error?{message:e.$i18n(e.error.message),type:e.error.type}:null,"menu-items":e.searchResults,"search-input":e.search,placeholder:e.placeholder,label:e.label,disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)},"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t},scroll:e.handleScroll},scopedSlots:e._u([{key:"no-results",fn:function(){return[e._v(e._s(e.noMatchFoundMessage))]},proxy:!0},e.tooltip?{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"top-end",message:e.tooltip}})]},proxy:!0}:null],null,!0)})},S=[],L=(r("99af"),r("d81d"),r("b047")),D=r.n(L),$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"querybuilder-tooltip"},[r("Popover",{attrs:{reactToHover:!0,position:e.position},scopedSlots:e._u([{key:"target",fn:function(){return[r("Button",{attrs:{variant:"quiet",type:"neutral",iconOnly:"","aria-label":"open tooltip with more information"}},[r("Icon",{attrs:{type:"info-outlined",size:"small"}})],1)]},proxy:!0}])},[r("div",{domProps:{innerHTML:e._s(e.message)}})])],1)},N=[],F=n["default"].extend({name:"InfoTooltip",components:{Icon:x["Icon"],Button:x["Button"],Popover:x["Popover"]},props:{position:{type:String,required:!0},message:{type:String,required:!0}}}),M=F,U=(r("b067"),Object(b["a"])(M,$,N,!1,null,null,null)),A=U.exports,Q=12,G=n["default"].extend({name:"EntityLookup",components:{InfoTooltip:A,Lookup:x["Lookup"]},data:function(){return{search:"",searchResults:[],topItemIndex:1,debouncedUpdateMenuItems:null}},methods:{handleScroll:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(t.topItemIndex<=e)){r.next=8;break}return t.topItemIndex+=Q,n={search:t.search,offset:t.topItemIndex,limit:Q},r.t0=t.searchResults,r.next=6,t.searchEntities(n);case 6:r.t1=r.sent,t.searchResults=r.t0.concat.call(r.t0,r.t1);case 8:case"end":return r.stop()}}),r)})))()},searchEntities:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.searchForMenuItems(e);case 2:return n=r.sent,r.abrupt("return",n.map((function(e){return e.tag=e.tag&&t.$i18n(e.tag),e})));case 4:case"end":return r.stop()}}),r)})))()},updateMenuItems:function(e){var t=this;null===this.debouncedUpdateMenuItems&&(this.debouncedUpdateMenuItems=D()(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.searchForMenuItems(r);case 2:t.searchResults=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),150)),this.debouncedUpdateMenuItems(e)}},watch:{disabled:function(e){e&&(this.search="")},search:function(e){if(this.topItemIndex=0,e){var t={search:e,limit:Q};this.updateMenuItems(t)}else this.searchResults=[]}},mounted:function(){this.value&&this.value.label&&!this.search&&(this.search=this.value.label)},props:{searchForMenuItems:{type:Function,required:!0},value:{type:Object,default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1},label:{type:String,required:!0},noMatchFoundMessage:{type:String,required:!0},placeholder:{type:String,default:""},tooltip:{type:String,default:""}}}),z=G,W=Object(b["a"])(z,E,S,!1,null,null,null),H=W.exports,Y=n["default"].extend({name:"ItemValueLookup",components:{EntityLookup:H},methods:{searchForItems:function(e){return this.$store.dispatch("searchItemValues",e)}},props:{value:{type:Object,default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1}}}),J=Y,K=Object(b["a"])(J,j,B,!1,null,null,null),X=K.exports,Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("TextInput",{attrs:{label:e.$i18n("query-builder-input-value-label"),value:e.value,error:e.error?{message:e.$i18n(e.error.message),type:e.error.type}:null,placeholder:e.$i18n("query-builder-input-value-placeholder"),disabled:e.disabled},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"end",message:e.$i18n("query-builder-input-value-tooltip")}})]},proxy:!0}])})},ee=[],te=n["default"].extend({name:"StringValueInput",props:{value:{type:String,default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1}},components:{TextInput:x["TextInput"],InfoTooltip:A}}),re=te,ne=Object(b["a"])(re,Z,ee,!1,null,null,null),ie=ne.exports,ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("QuantityInput",{attrs:{label:e.$i18n("query-builder-quantity-value-label"),error:e.quantityError?{message:e.$i18n(e.quantityError.message),type:e.quantityError.type}:null,errorCause:e.quantityError?e.quantityError.subproperty:null,numberInputValue:e.numberInputValue,numberInputPlaceholder:e.$i18n("query-builder-quantity-value-number-input-placeholder"),unitLookupValue:e.unitLookupValue,unitLookupPlaceholder:e.$i18n("query-builder-quantity-value-unit-lookup-input-placeholder"),unitLookupLabel:e.$i18n("query-builder-quantity-value-unit-lookup-label"),unitLookupMenuItems:e.searchResults,unitLookupSearchInput:e.search,disabled:e.disabled},on:{"update:numberInputValue":[e.onValueChange,function(t){e.numberInputValue=t}],"update:unitLookupValue":[e.onValueChange,function(t){e.unitLookupValue=t}],"update:number-input-value":function(t){e.numberInputValue=t},"update:unit-lookup-value":function(t){e.unitLookupValue=t},"update:unitLookupSearchInput":function(t){e.search=t},"update:unit-lookup-search-input":function(t){e.search=t},scroll:e.handleScroll},scopedSlots:e._u([{key:"no-results",fn:function(){return[e._v(" "+e._s(e.$i18n("query-builder-property-lookup-no-match-found"))+" ")]},proxy:!0},{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"top-end",message:e.$i18n("query-builder-input-value-tooltip")}})]},proxy:!0}])})},oe=[],ue=(r("25f0"),function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"isValidNumberValue",value:function(e){return null!==e&&!isNaN(Number(e))}},{key:"validateQuantityValue",value:function(t){return t?t.value||!t.rawUnitInput||t.unit?t.value?t.rawUnitInput&&!t.unit?e.UNIT_ERROR:null:e.NUMBER_ERROR:e.COMBINED_ERROR:e.NUMBER_ERROR}}]),e}());ue.NUMBER_ERROR={type:"error",message:"query-builder-quantity-value-error-number",subproperty:"number"},ue.UNIT_ERROR={type:"error",message:"query-builder-quantity-value-error-unit",subproperty:"unit"},ue.COMBINED_ERROR={type:"error",message:"query-builder-quantity-value-error-number-and-unit",subproperty:"both"};var se,le,ce=12,de=n["default"].extend({name:"QuantityValueInput",data:function(){return{search:"",searchResults:[],topItemIndex:1,numberInputValue:null===this.value?null:this.value.value.toString(),unitLookupValue:null===this.value?null:this.value.unit,debouncedUpdateMenuItems:null,quantityError:this.error}},methods:{parseNumberInputValue:function(e){return(new ue).isValidNumberValue(e)?(this.quantityError=null,Number(e)):(this.quantityError=ue.NUMBER_ERROR,NaN)},onValueChange:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$nextTick();case 2:r={value:e.parseNumberInputValue(e.numberInputValue),unit:e.unitLookupValue,rawUnitInput:e.search},e.$emit("input",r);case 4:case"end":return t.stop()}}),t)})))()},handleScroll:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(t.topItemIndex<=e)){r.next=8;break}return t.topItemIndex+=ce,n={search:t.search,offset:t.topItemIndex,limit:ce},r.t0=t.searchResults,r.next=6,t.searchEntities(n);case 6:r.t1=r.sent,t.searchResults=r.t0.concat.call(r.t0,r.t1);case 8:case"end":return r.stop()}}),r)})))()},searchEntities:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.searchForItems(e);case 2:return n=r.sent,r.abrupt("return",n.map((function(e){return e.tag=e.tag&&t.$i18n(e.tag),e})));case 4:case"end":return r.stop()}}),r)})))()},searchForItems:function(e){return this.$store.dispatch("searchItemValues",e)},updateMenuItems:function(e){var t=this;null===this.debouncedUpdateMenuItems&&(this.debouncedUpdateMenuItems=D()(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.searchForItems(r);case 2:t.searchResults=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),150)),this.debouncedUpdateMenuItems(e)}},watch:{disabled:function(e){e&&(this.search="",this.numberInputValue="")},search:function(e){if(this.onValueChange(),this.topItemIndex=0,e){var t={search:e,limit:ce};this.updateMenuItems(t)}else this.searchResults=[]},error:function(e){this.quantityError=e}},mounted:function(){var e,t;null!==(e=this.value)&&void 0!==e&&null!==(t=e.unit)&&void 0!==t&&t.id&&!this.search&&(this.search=this.value.unit.id)},props:{value:{type:Object,default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1}},components:{QuantityInput:x["QuantityInput"],InfoTooltip:A}}),pe=de,he=Object(b["a"])(pe,ae,oe,!1,null,null,null),me=he.exports,ye=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("DateInput",{attrs:{label:e.$i18n("query-builder-date-input-value-label"),placeholder:e.$i18n("query-builder-date-input-placeholder"),promptText:e.$i18n("query-builder-date-input-prompt-text"),resultsIntroText:e.$i18n("query-builder-date-input-results-intro-text"),calendarNotice:e.$i18n("query-builder-date-input-calendar-notice-text"),error:e.error?{message:e.$i18n(e.error.message),type:e.error.type}:null,parsedValue:e.value&&e.value.formattedValue?e.value.formattedValue:null,disabled:e.disabled},on:{input:function(t){return e.onInput(t)}},scopedSlots:e._u([{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"top-end",message:e.$i18n("query-builder-input-value-tooltip")}})]},proxy:!0}]),model:{value:e.rawInput,callback:function(t){e.rawInput=t},expression:"rawInput"}})},fe=[],be=n["default"].extend({name:"DateValueInput",data:function(){return{rawInput:"",debouncedDateValue:null}},methods:{onInput:function(e){var t=this;null===this.debouncedDateValue&&(this.debouncedDateValue=D()(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$emit("input",r);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),150)),this.debouncedDateValue(e)}},mounted:function(){this.value&&(this.rawInput=this.value.formattedValue||"")},props:{value:{type:Object,default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1}},watch:{disabled:function(e){e&&(this.rawInput="")}},components:{DateInput:x["DateInput"],InfoTooltip:A}}),ve=be,ge=Object(b["a"])(ve,ye,fe,!1,null,null,null),we=ge.exports,xe=n["default"].extend({name:"ValueInput",components:{StringValueInput:ie,ItemValueLookup:X,QuantityValueInput:me,DateValueInput:we},computed:{dispatchComponent:function(){switch(this.datatype){case"wikibase-item":return"ItemValueLookup";case"quantity":return"QuantityValueInput";case"time":return"DateValueInput";case"string":case"external-id":default:return"StringValueInput"}}},props:{datatype:{required:!0},value:{default:null},error:{type:Object,default:null},disabled:{type:Boolean,default:!1}}}),ke=xe,Re=Object(b["a"])(ke,P,C,!1,null,null,null),Te=Re.exports,Ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Button",{staticClass:"delete-condition",attrs:{iconOnly:"",type:"neutral",variant:"quiet","aria-label":e.$i18n("query-builder-delete-condition"),disabled:e.disabled},nativeOn:{click:function(t){return e.$emit("click")}}},[r("Icon",{staticClass:"delete-condition__icon",attrs:{type:"trash",size:"large",color:"inherit"}})],1)},Oe=[],Ve=n["default"].extend({name:"DeleteConditionButton",props:{disabled:{type:Boolean,default:!1}},components:{Button:x["Button"],Icon:x["Icon"]}}),qe=Ve,_e=(r("c8be"),Object(b["a"])(qe,Ie,Oe,!1,null,null,null)),Pe=_e.exports,Ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("EntityLookup",{attrs:{value:e.value,error:e.error,searchForMenuItems:e.searchForProperties,tooltip:e.$i18n("query-builder-property-lookup-tooltip"),label:e.$i18n("query-builder-property-lookup-label"),placeholder:e.$i18n("query-builder-property-lookup-placeholder"),"no-match-found-message":e.$i18n("query-builder-property-lookup-no-match-found")},on:{input:function(t){return e.$emit("input",t)}}})},je=[],Be=n["default"].extend({name:"PropertyLookup",components:{EntityLookup:H},methods:{setTagForSearchResults:function(e){var t=this;return e.map((function(e){return e.tag&&(e.tag=t.$i18n(e.tag)),e}))},searchForProperties:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.t0=t,r.next=3,t.$store.dispatch("searchProperties",e);case 3:return r.t1=r.sent,r.abrupt("return",r.t0.setTagForSearchResults.call(r.t0,r.t1));case 5:case"end":return r.stop()}}),r)})))()}},props:{value:{type:Object,default:null},error:{type:Object,default:null}}}),Ee=Be,Se=Object(b["a"])(Ee,Ce,je,!1,null,null,null),Le=Se.exports,De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder-dropdown"},[r("Dropdown",{staticClass:"querybuilder-dropdown__select",attrs:{value:e.selected,label:"Value Type",menuItems:e.optionItems,disabled:e.disabled},on:{input:e.onInput}})],1)},$e=[],Ne=(r("7db0"),r("07ac"),r("2909"));(function(e){e["Matching"]="matching",e["NotMatching"]="without",e["Regardless"]="regardless-of-value"})(se||(se={})),function(e){e["LessThan"]="less-than",e["MoreThan"]="more-than"}(le||(le={}));var Fe,Me=Object(l["a"])(Object(l["a"])({},se),le),Ue=Me,Ae=n["default"].extend({name:"ValueTypeDropDown",props:{value:{type:String,required:!0},datatype:{type:String,default:null},disabled:{type:Boolean,default:!1}},methods:{onInput:function(e){this.$emit("input",e.value)}},computed:{optionItems:function(){var e=this,t=Object.values(se).map((function(t){return{label:e.$i18n("query-builder-value-type-relation-dropdown-".concat(t)),description:"",value:t}}));return"quantity"===this.datatype&&t.push.apply(t,Object(Ne["a"])(Object.values(le).map((function(t){return{label:e.$i18n("query-builder-value-type-relation-dropdown-".concat(t,"-quantity")),description:"",value:t}})))),"time"===this.datatype&&t.push.apply(t,Object(Ne["a"])(Object.values(le).map((function(t){return{label:e.$i18n("query-builder-value-type-relation-dropdown-".concat(t,"-date")),description:"",value:t}})))),t},selected:function(){var e=this;return this.optionItems.find((function(t){return t.value===e.value}))||null}},components:{Dropdown:x["Dropdown"]}}),Qe=Ae,Ge=(r("06c6"),Object(b["a"])(Qe,De,$e,!1,null,null,null)),ze=Ge.exports,We=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder-include-subclasses"},[r("Checkbox",{staticClass:"querybuilder-include-subclasses__checkbox",attrs:{id:e.id,checked:e.isChecked,disabled:e.disabled,label:e.$i18n("query-builder-include-subclasses")},on:{"update:checked":function(t){return e.$emit("subclass-check",t)}},scopedSlots:e._u([{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"end",message:e.$i18n("query-builder-include-subclasses-tooltip")}})]},proxy:!0}])})],1)},He=[],Ye=n["default"].extend({name:"SubclassCheckbox",data:function(){return{id:"include-subclasses-".concat(Math.random())}},props:{isChecked:{type:Boolean,required:!0},disabled:{type:Boolean,default:!1}},components:{Checkbox:x["Checkbox"],InfoTooltip:A}}),Je=Ye,Ke=(r("18b8"),Object(b["a"])(Je,We,He,!1,null,null,null)),Xe=Ke.exports,Ze=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"query-condition-references"},[r("Dropdown",{staticClass:"query-condition-references__select",attrs:{value:e.selected,label:e.$i18n("query-builder-reference-relation-label"),menuItems:e.optionItems,disabled:e.disabled},on:{input:e.onInput},scopedSlots:e._u([{key:"suffix",fn:function(){return[r("InfoTooltip",{attrs:{position:"top",message:e.$i18n("query-builder-reference-relation-tooltip")}})]},proxy:!0}])})],1)},et=[];(function(e){e["With"]="with",e["Without"]="without",e["Regardless"]="regardless"})(Fe||(Fe={}));var tt,rt=Fe,nt=n["default"].extend({name:"ReferenceRelationDropDown",props:{value:{type:String,required:!0},disabled:{type:Boolean,default:!1}},methods:{onInput:function(e){this.$emit("input",e.value)}},computed:{optionItems:function(){var e=this;return Object.values(rt).map((function(t){return{label:e.$i18n("query-builder-reference-relation-dropdown-".concat(t)),description:"",value:t}}))},selected:function(){var e=this;return this.optionItems.find((function(t){return t.value===e.value}))||null}},components:{Dropdown:x["Dropdown"],InfoTooltip:A}}),it=nt,at=Object(b["a"])(it,Ze,et,!1,null,null,null),ot=at.exports,ut=r("f13c"),st=r.n(ut),lt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ToggleButtonGroup",{staticClass:"negationToggle",attrs:{value:e.value},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"default",fn:function(){return[r("ToggleButton",{attrs:{value:"with"}},[e._v(" "+e._s(e.$i18n("query-builder-negation-option-label-with"))+" ")]),r("ToggleButton",{attrs:{value:"without"}},[e._v(" "+e._s(e.$i18n("query-builder-negation-option-label-without"))+" ")])]},proxy:!0}])})},ct=[],dt=n["default"].extend({name:"NegationToggle",components:{ToggleButton:x["ToggleButton"],ToggleButtonGroup:x["ToggleButtonGroup"]},props:{value:{type:String,default:"with"}}}),pt=dt,ht=Object(b["a"])(pt,lt,ct,!1,null,null,null),mt=ht.exports,yt=n["default"].extend({name:"QueryCondition",props:{conditionIndex:{type:Number,required:!0}},methods:{isValueInputDisabled:function(){return this.selectedPropertyValueRelation===Ue.Regardless},removeCondition:function(){this.$store.dispatch("removeCondition",this.conditionIndex)},setSubclasses:function(e){this.$store.dispatch("setSubclasses",{subclasses:e,conditionIndex:this.conditionIndex})}},computed:Object(l["a"])({datatype:function(){return this.$store.getters.datatype(this.conditionIndex)},selectedProperty:{get:function(){return this.$store.getters.property(this.conditionIndex)},set:function(e){null!==e?("wikibase-item"===e.datatype?this.$store.dispatch("setSubclasses",{conditionIndex:this.conditionIndex,subclasses:!0}):this.$store.dispatch("setSubclasses",{conditionIndex:this.conditionIndex,subclasses:!1}),e.datatype!==this.$store.getters.datatype(this.conditionIndex)&&(this.selectedPropertyValueRelation=Ue.Matching),this.$store.dispatch("updateProperty",{property:e,conditionIndex:this.conditionIndex})):this.$store.dispatch("unsetProperty",this.conditionIndex)}},isSubclassCheckboxVisible:function(){return"wikibase-item"===this.$store.getters.datatype(this.conditionIndex)},selectedPropertyValueRelation:{get:function(){return this.$store.getters.propertyValueRelation(this.conditionIndex)},set:function(e){e===Ue.Regardless&&(this.conditionValue=null),this.$store.dispatch("updatePropertyValueRelation",{propertyValueRelation:e,conditionIndex:this.conditionIndex})}},selectedReferenceRelation:{get:function(){return this.$store.getters.referenceRelation(this.conditionIndex)},set:function(e){this.$store.dispatch("setReferenceRelation",{referenceRelation:e,conditionIndex:this.conditionIndex})}},conditionValue:{get:function(){return this.$store.getters.value(this.conditionIndex)},set:function(e){this.$store.dispatch("updateValue",{value:e,conditionIndex:this.conditionIndex})}},negateValue:{get:function(){var e=this.$store.getters.negate(this.conditionIndex);return!0===e?"without":"with"},set:function(e){if("with"!==e&&"without"!==e)throw new st.a("Unknown negate value: "+e);var t="without"===e;this.$store.dispatch("setNegate",{value:t,conditionIndex:this.conditionIndex})}},valueError:function(){var e=this.$store.getters.valueError(this.conditionIndex);return null===e?null:Object(l["a"])(Object(l["a"])({},e),{},{message:this.$i18n(e.message)})}},Object(w["c"])(["propertyError","limitedSupport","subclasses"])),components:{ValueInput:Te,PropertyLookup:Le,ReferenceRelationDropDown:ot,ValueTypeDropDown:ze,DeleteConditionButton:Pe,NegationToggle:mt,SubclassCheckbox:Xe}}),ft=yt,bt=(r("43c8"),Object(b["a"])(ft,q,_,!1,null,"134d60f2",null)),vt=bt.exports,gt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder-result"},[r("div",{staticClass:"querybuilder-result__link"},[r("a",{attrs:{href:e.queryServiceUrl+(0!==e.encodedQuery.length?"#"+e.encodedQuery:""),target:"_blank"}},[e._v(" "+e._s(e.$i18n("query-builder-result-link-text"))+" ")])]),r("div",{staticClass:"querybuilder-result__header"},[r("h2",[e._v(e._s(e.$i18n("query-builder-result-header")))])]),0!==e.errors.length?r("div",{staticClass:"querybuilder-result__errors"},e._l(e.errors,(function(t,n){return r("Message",{key:n,attrs:{type:t.type}},[r("span",[e._v(e._s(e.$i18n(t.message)))])])})),1):0===e.encodedQuery.length?r("div",[r("div",{staticClass:"querybuilder-result__description"},[e._v(" "+e._s(e.$i18n("query-builder-result-placeholder"))+" ")])]):r("div",{staticClass:"querybuilder-result__wrapper"},[r("iframe",{key:e.iframeRenderKey,staticClass:"querybuilder-result__iframe",attrs:{src:e.queryServiceEmbedUrl+"#"+e.encodedQuery,referrerpolicy:"origin",sandbox:"allow-scripts allow-same-origin allow-popups allow-popups-to-escape-sandbox"}})])])},wt=[],xt=n["default"].extend({name:"QueryResult",data:function(){return{queryServiceEmbedUrl:"https://query.wikidata.org/embed.html",queryServiceUrl:"https://query.wikidata.org/"}},props:{encodedQuery:{type:String},iframeRenderKey:{type:Number}},methods:{updateInputTextValue:function(e){this.$store.dispatch("updateValue",e)}},computed:Object(l["a"])({},Object(w["c"])({errors:"getErrors"})),components:{Message:x["Message"]}}),kt=xt,Rt=(r("7c0f"),Object(b["a"])(kt,gt,wt,!1,null,null,null)),Tt=Rt.exports,It=(r("4fad"),r("3835")),Ot={wikibase:"http://wikiba.se/ontology#",wd:"http://www.wikidata.org/entity/",wdt:"http://www.wikidata.org/prop/direct/",wdtn:"http://www.wikidata.org/prop/direct-normalized/",wds:"http://www.wikidata.org/entity/statement/",p:"http://www.wikidata.org/prop/",wdref:"http://www.wikidata.org/reference/",wdv:"http://www.wikidata.org/value/",ps:"http://www.wikidata.org/prop/statement/",psv:"http://www.wikidata.org/prop/statement/value/",psn:"http://www.wikidata.org/prop/statement/value-normalized/",pq:"http://www.wikidata.org/prop/qualifier/",pqv:"http://www.wikidata.org/prop/qualifier/value/",pqn:"http://www.wikidata.org/prop/qualifier/value-normalized/",pr:"http://www.wikidata.org/prop/reference/",prv:"http://www.wikidata.org/prop/reference/value/",prn:"http://www.wikidata.org/prop/reference/value-normalized/",wdno:"http://www.wikidata.org/prop/novalue/",wdata:"http://www.wikidata.org/wiki/Special:EntityData/",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",owl:"http://www.w3.org/2002/07/owl#",skos:"http://www.w3.org/2004/02/skos/core#",xsd:"http://www.w3.org/2001/XMLSchema#",prov:"http://www.w3.org/ns/prov#",ontolex:"http://www.w3.org/ns/lemon/ontolex#",schema:"http://schema.org/",geo:"http://www.opengis.net/ont/geosparql#",geof:"http://www.opengis.net/def/geosparql/function/",dct:"http://purl.org/dc/terms/",bd:"http://www.bigdata.com/rdf#",bds:"http://www.bigdata.com/rdf/search#",gas:"http://www.bigdata.com/rdf/gas#",hint:"http://www.bigdata.com/queryHints#"},Vt=function(){function e(t){Object(p["a"])(this,e),this.sparqlGenerator=t}return Object(h["a"])(e,[{key:"getString",value:function(e){for(var t=this.sparqlGenerator.stringify(e),r=0,n=Object.entries(Ot);r<n.length;r++){var i=Object(It["a"])(n[r],2),a=i[0],o=i[1];t=t.replace("PREFIX ".concat(a,": <").concat(o,">\n"),"")}return t}}]),e}(),qt=Vt,_t=r("b4c9"),Pt=(r("4de4"),r("466d"),r("4d90"),r("53ca")),Ct=r("9558"),jt=function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"buildSimpleTriple",value:function(e,t,r){return{subject:e,predicate:{termType:"NamedNode",value:t},object:r}}},{key:"buildPathTriple",value:function(e,t,r){return{subject:e,predicate:this.buildPropertyPath("/",t.map((function(e){return"string"===typeof e?{termType:"NamedNode",value:e}:e}))),object:r}}},{key:"buildPropertyPath",value:function(e,t){return{type:"path",pathType:e,items:t}}},{key:"buildVariableTermFromName",value:function(e){return{termType:"Variable",value:e}}},{key:"buildBgpPattern",value:function(e){return{type:"bgp",triples:e}}},{key:"buildOperatorFilterPattern",value:function(e,t,r){return{type:"filter",expression:this.buildOperationsExpression(e,t,r)}}},{key:"buildOperationsExpression",value:function(e,t,r){return{type:"operation",operator:t,args:[e,r]}}},{key:"buildLiteralTermForDecimalNumber",value:function(e){return{termType:"Literal",value:String(e),datatype:{termType:"NamedNode",value:"http://www.w3.org/2001/XMLSchema#decimal"}}}},{key:"buildLiteralTermForDateTime",value:function(e){return{termType:"Literal",value:e,datatype:{termType:"NamedNode",value:"http://www.w3.org/2001/XMLSchema#dateTime"}}}}]),e}(),Bt=function(){function e(){Object(p["a"])(this,e),this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildReferenceFilterPattern",value:function(e,t){if(e===rt.Regardless)return null;var r=this.syntaxBuilder.buildSimpleTriple(t,Ot.prov+"wasDerivedFrom",{termType:"Variable",value:"reference"});return{type:"filter",expression:{type:"operation",operator:e===rt.With?"exists":"notexists",args:[this.syntaxBuilder.buildBgpPattern([r])]}}}},{key:"buildAnyValueTripe",value:function(){return{subject:{termType:"Variable",value:"item"},predicate:{termType:"NamedNode",value:Ot.wikibase+"sitelinks"},object:{termType:"BlankNode",value:"anyValue"}}}},{key:"buildLabelServiceTriple",value:function(){return{subject:{termType:"NamedNode",value:Ot.bd+"serviceParam"},predicate:{termType:"NamedNode",value:Ot.wikibase+"language"},object:{termType:"Literal",value:"[AUTO_LANGUAGE]"}}}}]),e}();(function(e){e[e["DAY"]=11]="DAY",e[e["MONTH"]=10]="MONTH",e[e["YEAR"]=9]="YEAR"})(tt||(tt={}));var Et=function(){function e(){Object(p["a"])(this,e),this.conditionIndex=null,this.tripleBuilder=new Bt,this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t){var r,n=e.propertyId,i=e.referenceRelation,a=e.propertyValueRelation,o=e.value,u=e.negate;return this.conditionIndex=t,r=a===Ue.Regardless?this.buildRegardlessOfValuePattern(n):this.buildValuePattern(n,o,a),r=this.addReferenceFilterPatternIfNeeded(r,i),r=this.negatePatternsIfNeeded(r,u),r}},{key:"buildValuePattern",value:function(e,t,r){if(!this.isDateValue(t))throw new Error("Unexpected value for date: "+JSON.stringify(t));var n;return n=t.precision===tt.DAY?this.buildDayPrecisionPatterns(e,t,r):this.buildLowPrecisionPatterns(e,t,r),n}},{key:"buildRegardlessOfValuePattern",value:function(e){var t=[];return t=this.addEntityToStatementPattern(t,e),t=this.addStatementToStatementValuePattern(t,e),t=this.addStatementValueToTimeValuePattern(t,e),t}},{key:"buildDayPrecisionPatterns",value:function(e,t,r){var n=[];n=this.addEntityToStatementPattern(n,e),n=this.addStatementToStatementValuePattern(n,e),n=this.addStatementValueToPrecisionPattern(n),n=this.addPrecisionFilterPattern(n,t),n=this.addStatementValueToTimeValuePattern(n,e);var i=this.getConditionVariable(e);if(r===Ue.Matching){var a={type:"bind",variable:i,expression:this.syntaxBuilder.buildLiteralTermForDateTime(t.value)};n.push(a)}if(r===Ue.NotMatching){var o=this.syntaxBuilder.buildOperatorFilterPattern(i,"!=",this.syntaxBuilder.buildLiteralTermForDateTime(t.value));n.push(o)}if(r===Ue.LessThan){var u=this.syntaxBuilder.buildOperatorFilterPattern(i,"<",this.syntaxBuilder.buildLiteralTermForDateTime(t.value));n.push(u)}if(r===Ue.MoreThan){var s=this.syntaxBuilder.buildOperatorFilterPattern(i,">",this.syntaxBuilder.buildLiteralTermForDateTime(t.value));n.push(s)}return n}},{key:"buildLowPrecisionPatterns",value:function(e,t,r){var n=[];return n=this.addEntityToStatementPattern(n,e),n=this.addStatementToStatementValuePattern(n,e),n=this.addStatementValueToPrecisionPattern(n),n=this.addRangeSafeHintPattern(n),n=this.addPrecisionFilterPattern(n,t),n=this.addStatementValueToTimeValuePattern(n,e),n=this.addRangeSafeHintPattern(n),n=this.addDateTimeFilterPattern(n,t,e,r),n}},{key:"addDateTimeFilterPattern",value:function(e,t,r,n){var i=this.buildDateTimeFilterPattern(t,r,n);return e.push(i),e}},{key:"buildDateTimeFilterPattern",value:function(e,t,r){var n;switch(e.precision){case tt.MONTH:n=this.calculateFollowingMonthDateTime(e.value);break;case tt.YEAR:n=this.calculateFollowingYearDateTime(e.value);break;default:throw new Error("Unexpected precision value: "+e.precision)}var i=this.getConditionVariable(t);if(r===Ue.Matching)return this.syntaxBuilder.buildOperatorFilterPattern(this.syntaxBuilder.buildOperationsExpression(this.syntaxBuilder.buildLiteralTermForDateTime(e.value),"<=",i),"&&",this.syntaxBuilder.buildOperationsExpression(i,"<",this.syntaxBuilder.buildLiteralTermForDateTime(n)));if(r===Ue.NotMatching)return this.syntaxBuilder.buildOperatorFilterPattern(this.syntaxBuilder.buildOperationsExpression(this.syntaxBuilder.buildLiteralTermForDateTime(e.value),"<",i),"||",this.syntaxBuilder.buildOperationsExpression(i,">=",this.syntaxBuilder.buildLiteralTermForDateTime(n)));if(r===Ue.LessThan)return this.syntaxBuilder.buildOperatorFilterPattern(i,"<",this.syntaxBuilder.buildLiteralTermForDateTime(e.value));if(r===Ue.MoreThan)return this.syntaxBuilder.buildOperatorFilterPattern(i,">=",this.syntaxBuilder.buildLiteralTermForDateTime(n));throw new Error("Unexpected property value relation: "+r)}},{key:"calculateFollowingYearDateTime",value:function(e){var t=e.match(Object(Ct["a"])(/^([\+\x2D])([0-9]+)/,{sign:1,year:2}));if(null===t||!t.groups)throw new Error("date string not in expected format: "+e);var r=t.groups,n=r.year,i=r.sign,a="+"===i?(Number(n)+1).toString():(Number(n)-1).toString();return"".concat(i).concat(a,"-00-00T00:00:00Z")}},{key:"calculateFollowingMonthDateTime",value:function(e){var t=e.match(Object(Ct["a"])(/^([\+\x2D])([0-9]+)\x2D([0-9]{2})/,{sign:1,year:2,month:3}));if(null===t||!t.groups)throw new Error("date string not in expected format: "+e);var r,n,i=t.groups,a=i.year,o=i.month,u=i.sign;return"12"!==o?(r=(Number(o)+1).toString().padStart(2,"0"),n=a):(r="01",n="+"===u?(Number(a)+1).toString():(Number(a)-1).toString()),"".concat(u).concat(n,"-").concat(r,"-00T00:00:00Z")}},{key:"addEntityToStatementPattern",value:function(e,t){var r=this.getConditionVariable("statement"),n=this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+t,r);return e.push(this.syntaxBuilder.buildBgpPattern([n])),e}},{key:"addStatementToStatementValuePattern",value:function(e,t){var r=this.getConditionVariable("statement"),n=this.getConditionVariable("statementValue"),i=this.syntaxBuilder.buildSimpleTriple(r,Ot.psv+t,n);return e.push(this.syntaxBuilder.buildBgpPattern([i])),e}},{key:"addStatementValueToTimeValuePattern",value:function(e,t){var r=this.getConditionVariable("statementValue"),n=this.getConditionVariable(t),i=this.syntaxBuilder.buildSimpleTriple(r,Ot.wikibase+"timeValue",n);return e.push(this.syntaxBuilder.buildBgpPattern([i])),e}},{key:"addStatementValueToPrecisionPattern",value:function(e){var t=this.getConditionVariable("statementValue"),r=this.getConditionVariable("precision"),n=this.syntaxBuilder.buildSimpleTriple(t,Ot.wikibase+"timePrecision",r),i=this.syntaxBuilder.buildBgpPattern([n]);return e.push(i),e}},{key:"addRangeSafeHintPattern",value:function(e){var t=this.syntaxBuilder.buildSimpleTriple({termType:"NamedNode",value:Ot.hint+"Prior"},Ot.hint+"rangeSafe",{termType:"Literal",value:"true",datatype:{termType:"NamedNode",value:Ot.xsd+"boolean"}}),r=this.syntaxBuilder.buildBgpPattern([t]);return e.push(r),e}},{key:"addPrecisionFilterPattern",value:function(e,t){var r=this.getConditionVariable("precision"),n=this.syntaxBuilder.buildOperatorFilterPattern(r,">=",{termType:"Literal",value:String(t.precision),datatype:{termType:"NamedNode",value:"http://www.w3.org/2001/XMLSchema#integer"}});return e.push(n),e}},{key:"addReferenceFilterPatternIfNeeded",value:function(e,t){var r=this.tripleBuilder.buildReferenceFilterPattern(t,this.getConditionVariable("statement"));return null!==r&&(e.push(r),e=[{type:"group",patterns:e}]),e}},{key:"negatePatternsIfNeeded",value:function(e,t){return t?[{type:"minus",patterns:e}]:e}},{key:"getConditionVariable",value:function(e){if(null===this.conditionIndex)throw new Error("initializing condition index failed!");return this.syntaxBuilder.buildVariableTermFromName("".concat(e,"_").concat(this.conditionIndex))}},{key:"isDateValue",value:function(e){return"object"===Object(Pt["a"])(e)&&"string"===typeof e.value&&"number"===typeof e.precision}}]),e}(),St=function(){function e(){Object(p["a"])(this,e),this.tripleBuilder=new Bt,this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t,r){var n=e.propertyId,i=e.referenceRelation,a=e.propertyValueRelation,o=e.datatype,u=e.value,s=e.negate,l=e.subclasses;if("wikibase-item"!==o)throw new Error("Expected datatype wikibase-item, got: "+o);if("string"!==typeof u)throw new Error("Unexpected wikibase-item value type: "+Object(Pt["a"])(u));var c=[],d=this.syntaxBuilder.buildVariableTermFromName("statement"+t),p=this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+n,d),h=this.syntaxBuilder.buildPathTriple(d,this.buildStatementToValuePredicateItems(n,l),this.buildObjectItems(n,a,u,r)),m=this.syntaxBuilder.buildBgpPattern([p,h]);c.push(m);var y=this.tripleBuilder.buildReferenceFilterPattern(i,d);if(null!==y&&(c.push(y),c=[{type:"group",patterns:c}]),s&&(c=[{type:"minus",patterns:c}]),a===Ue.NotMatching){var f=this.buildNotMatchingPattern(n,u);c.push(f)}return c}},{key:"buildNotMatchingPattern",value:function(e,t){var r=this.syntaxBuilder.buildPathTriple({termType:"Variable",value:"item"},[Ot.p+e,Ot.ps+e],{termType:"NamedNode",value:"".concat(Ot.wd).concat(t)});return{type:"minus",patterns:[this.syntaxBuilder.buildBgpPattern([r])]}}},{key:"buildStatementToValuePredicateItems",value:function(e,t){var r=[Ot.ps+e];return t&&r.push(this.syntaxBuilder.buildPropertyPath("*",[{termType:"NamedNode",value:Ot.wdt+this.getSubclassPropertyId(e)}])),r}},{key:"getSubclassPropertyId",value:function(e){var t=JSON.parse('{"default": "P279", "P171": "P171", "P131":"P131"}');return t[e]?t[e]:t.default}},{key:"buildObjectItems",value:function(e,t,r,n){switch(t){case Ue.NotMatching:return{termType:"Variable",value:"instance"};case Ue.Regardless:return{termType:"BlankNode",value:""!==n?"anyValue".concat(e,"_").concat(n):"anyValue".concat(e)};case Ue.Matching:return{termType:"NamedNode",value:"".concat(Ot.wd).concat(r)};default:throw new Error("unsupported relation: ".concat(t))}}}]),e}(),Lt=function(){function e(){Object(p["a"])(this,e),this.tripleBuilder=new Bt,this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t,r){var n=e.propertyId,i=e.referenceRelation,a=e.propertyValueRelation,o=e.negate;if(a!==Ue.Regardless)throw new Error("datatypes with limited support _must_ have PropertyValueRelation.Regardless!");var u=[],s=this.syntaxBuilder.buildVariableTermFromName("statement"+t),l=this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+n,s),c=this.syntaxBuilder.buildPathTriple(s,[Ot.ps+n],{termType:"BlankNode",value:""!==r?"anyValue".concat(n,"_").concat(r):"anyValue".concat(n)}),d=this.syntaxBuilder.buildBgpPattern([l,c]);u.push(d);var p=this.tripleBuilder.buildReferenceFilterPattern(i,s);return null!==p&&(u.push(p),u=[{type:"group",patterns:u}]),o&&(u=[{type:"minus",patterns:u}]),u}}]),e}(),Dt=function(){function e(){Object(p["a"])(this,e),this.tripleBuilder=new Bt,this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t){var r,n=e.propertyId,i=e.negate,a=e.referenceRelation,o=e.propertyValueRelation,u=e.datatype,s=e.value;if("quantity"!==u)throw new Error("Unexpected datatype: "+u);return r=o===Ue.Regardless?this.buildRegardlessOfValuePattern(n,t,a):this.buildValuePatterns(s,o,n,t,a),i?[{type:"minus",patterns:r}]:r}},{key:"buildValuePatterns",value:function(e,t,r,n,i){if(!this.isQuantityValue(e))throw new Error("Unexpected value quantity value: "+JSON.stringify(e));var a=e.value,o=e.unit;return null===o||t===Ue.Regardless?this.buildPatternsForUnitlessValue(r,a,n,i,t):this.buildFullQuantityPattern(a,o,n,r,i,t)}},{key:"buildRegardlessOfValuePattern",value:function(e,t,r){var n=this.syntaxBuilder.buildVariableTermFromName("numericQuantity"),i=this.syntaxBuilder.buildVariableTermFromName("statement"+t),a=this.syntaxBuilder.buildBgpPattern([this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+e,i),this.syntaxBuilder.buildPathTriple(i,[Ot.psv+e,Ot.wikibase+"quantityAmount"],n)]),o=[a],u=this.tripleBuilder.buildReferenceFilterPattern(r,i);return null!==u&&o.push(u),o}},{key:"buildFullQuantityPattern",value:function(e,t,r,n,i,a){var o=[],u=this.syntaxBuilder.buildVariableTermFromName("userQuantity"),s={type:"bind",variable:u,expression:this.syntaxBuilder.buildLiteralTermForDecimalNumber(e)};o.push(s);var l=this.syntaxBuilder.buildVariableTermFromName("userUnit"),c={type:"bind",variable:l,expression:{termType:"NamedNode",value:"".concat(Ot.wd).concat(t)}};o.push(c);var d=this.getSiConversionPropertyId(),p=this.syntaxBuilder.buildVariableTermFromName("conversionFactor"),h=this.syntaxBuilder.buildPathTriple(l,[Ot.p+d,Ot.psv+d,Ot.wikibase+"quantityAmount"],p),m=this.syntaxBuilder.buildVariableTermFromName("coherentUnit"),y=this.syntaxBuilder.buildPathTriple(l,[Ot.p+d,Ot.psv+d,Ot.wikibase+"quantityUnit"],m),f=this.syntaxBuilder.buildBgpPattern([h,y]);o.push(f);var b=this.syntaxBuilder.buildVariableTermFromName("coherentUserQuantity"),v={type:"bind",variable:b,expression:this.syntaxBuilder.buildOperationsExpression(u,"*",p)};o.push(v);var g=this.syntaxBuilder.buildVariableTermFromName("statement"+r),w=this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+n,g),x=this.syntaxBuilder.buildVariableTermFromName("statementQuantity"),k=this.syntaxBuilder.buildPathTriple(g,[Ot.psn+n,Ot.wikibase+"quantityAmount"],x),R=this.syntaxBuilder.buildPathTriple(g,[Ot.psn+n,Ot.wikibase+"quantityUnit"],m),T=this.syntaxBuilder.buildBgpPattern([w,k,R]);o.push(T);var I=this.getFilterOperatorFromRelation(a);if(null!==I){var O=this.syntaxBuilder.buildOperatorFilterPattern(x,I,b);o.push(O)}var V=this.tripleBuilder.buildReferenceFilterPattern(i,g);return null!==V&&o.push(V),o}},{key:"buildPatternsForUnitlessValue",value:function(e,t,r,n,i){var a=[],o=this.syntaxBuilder.buildVariableTermFromName("numericQuantity"),u=this.syntaxBuilder.buildVariableTermFromName("statement"+r),s=this.syntaxBuilder.buildBgpPattern([this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+e,u),this.syntaxBuilder.buildPathTriple(u,[Ot.psv+e,Ot.wikibase+"quantityAmount"],o)]);a.push(s);var l=this.getFilterOperatorFromRelation(i);if(null!==l){var c=this.syntaxBuilder.buildOperatorFilterPattern(o,l,this.syntaxBuilder.buildLiteralTermForDecimalNumber(t));a.push(c)}var d=this.tripleBuilder.buildReferenceFilterPattern(n,u);return null!==d&&a.push(d),a}},{key:"isQuantityValue",value:function(e){return"object"===Object(Pt["a"])(e)&&(null===e.unit||"string"===typeof e.unit)}},{key:"getFilterOperatorFromRelation",value:function(e){switch(e){case Ue.Matching:return"=";case Ue.NotMatching:return"!=";case Ue.LessThan:return"<";case Ue.MoreThan:return">";case Ue.Regardless:return null}}},{key:"getSiConversionPropertyId",value:function(){return"P2370"}}]),e}(),$t=(r("caad"),r("2532"),function(){function e(){Object(p["a"])(this,e),this.ALLOWED_DATATYPES=["string","external-id"],this.tripleBuilder=new Bt,this.syntaxBuilder=new jt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t,r){var n=e.propertyId,i=e.referenceRelation,a=e.propertyValueRelation,o=e.datatype,u=e.value,s=e.negate;if(!this.ALLOWED_DATATYPES.includes(o))throw new Error("Unexpected datatype: "+o);if("string"!==typeof u)throw new Error("Unexpected value type: "+Object(Pt["a"])(u));var l=[],c=this.syntaxBuilder.buildVariableTermFromName("statement"+t),d=this.syntaxBuilder.buildSimpleTriple({termType:"Variable",value:"item"},Ot.p+n,c),p=this.syntaxBuilder.buildPathTriple(c,[Ot.ps+n],this.buildObjectItems(n,a,u,r)),h=this.syntaxBuilder.buildBgpPattern([d,p]);l.push(h);var m=this.tripleBuilder.buildReferenceFilterPattern(i,c);if(null!==m&&(l.push(m),l=[{type:"group",patterns:l}]),s&&(l=[{type:"minus",patterns:l}]),a===Ue.NotMatching){var y=this.buildNotMatchingPattern(n,u);l.push(y)}return l}},{key:"buildNotMatchingPattern",value:function(e,t){var r=this.syntaxBuilder.buildPathTriple({termType:"Variable",value:"item"},[Ot.p+e,Ot.ps+e],{termType:"Literal",value:t});return{type:"minus",patterns:[this.syntaxBuilder.buildBgpPattern([r])]}}},{key:"buildObjectItems",value:function(e,t,r,n){switch(t){case Ue.NotMatching:return{termType:"Variable",value:"instance"};case Ue.Regardless:return{termType:"BlankNode",value:""!==n?"anyValue".concat(e,"_").concat(n):"anyValue".concat(e)};case Ue.Matching:return{termType:"Literal",value:r};default:throw new Error("unsupported relation: ".concat(t))}}}]),e}()),Nt=function(){function e(){Object(p["a"])(this,e),this.tripleBuilder=new Bt}return Object(h["a"])(e,[{key:"buildValuePatternFromCondition",value:function(e,t,r){return this.getValuePatternBuilderForDatatype(e.datatype).buildValuePatternFromCondition(e,t,r)}},{key:"getValuePatternBuilderForDatatype",value:function(e){switch(e){case"string":case"external-id":return new $t;case"wikibase-item":return new St;case"quantity":return new Dt;case"time":return new Et;default:return new Lt}}},{key:"buildLabelServicePattern",value:function(){return{type:"bgp",triples:[this.tripleBuilder.buildLabelServiceTriple()]}}},{key:"buildAnyValuePattern",value:function(){return{type:"bgp",triples:[this.tripleBuilder.buildAnyValueTripe()]}}}]),e}(),Ft=function(){function e(t){Object(p["a"])(this,e),this.conditionIndex=0,this.queryObject={queryType:"SELECT",distinct:!0,variables:[],where:[],type:"query",prefixes:Ot},this.patternBuilder=new Nt,this.queryRepresentation=t,this.conditions=this.buildConditionTree(t.conditions)}return Object(h["a"])(e,[{key:"buildFromQueryRepresentation",value:function(){var e=this;if(this.queryObject.variables=[{termType:"Variable",value:"item"}],this.conditions.forEach((function(t){Array.isArray(t)?e.buildUnion(t):e.buildFromQueryCondition(t)})),this.queryObject.where){for(var t=!0,r=0;r<(null===(n=this.queryObject.where)||void 0===n?void 0:n.length);r++){var n,i=this.queryObject.where[r].type;if("minus"!==i){t=!1;break}}t&&this.queryObject.where.unshift(this.patternBuilder.buildAnyValuePattern())}return this.queryRepresentation.limit&&(this.queryObject.limit=this.queryRepresentation.limit),this.queryRepresentation.omitLabels?this.queryObject:this.wrapQueryWithLabel()}},{key:"propertyRegardlessOfValueOccursMoreThanOnce",value:function(e){return this.queryRepresentation.conditions.filter((function(t){return t.propertyId===e&&t.referenceRelation===rt.Regardless})).length>1}},{key:"buildConditionTree",value:function(e){var t=this,r=[];return e.forEach((function(e){"and"!==e.conditionRelation&&null!==e.conditionRelation?t.attachToPreviousConditionWithOr(r,e):t.attachToRootWithAnd(r,e)})),r}},{key:"attachToPreviousConditionWithOr",value:function(e,t){this.lastElementIsSingleCondition(e)&&this.makeLastElementIntoConditionGroup(e),this.attachToExistingConditionGroup(e,t)}},{key:"attachToExistingConditionGroup",value:function(e,t){e[e.length-1].push(t)}},{key:"lastElementIsSingleCondition",value:function(e){return!Array.isArray(e[e.length-1])}},{key:"makeLastElementIntoConditionGroup",value:function(e){e.push([e.pop()])}},{key:"attachToRootWithAnd",value:function(e,t){e.push(t)}},{key:"buildUnion",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=this.conditionIndex++,i=this.propertyRegardlessOfValueOccursMoreThanOnce(e[r].propertyId)?n.toString():"",a={type:"group",patterns:this.patternBuilder.buildValuePatternFromCondition(e[r],n,i)};t.push(a)}var o={type:"union",patterns:t};this.queryObject.where||(this.queryObject.where=[]),this.queryObject.where.push(o)}},{key:"buildFromQueryCondition",value:function(e){var t;this.queryObject.where||(this.queryObject.where=[]);var r=this.conditionIndex++,n=this.propertyRegardlessOfValueOccursMoreThanOnce(e.propertyId)?r.toString():"";(t=this.queryObject.where).push.apply(t,Object(Ne["a"])(this.patternBuilder.buildValuePatternFromCondition(e,r,n)))}},{key:"wrapQueryWithLabel",value:function(){var e={queryType:"SELECT",distinct:!0,variables:[{termType:"Variable",value:"item"},{termType:"Variable",value:"itemLabel"},{termType:"Variable",value:"itemDescription"}],where:[{type:"service",patterns:[this.patternBuilder.buildLabelServicePattern()],name:{termType:"NamedNode",value:Ot.wikibase+"label"},silent:!1}],type:"query",prefixes:Ot};return e.where||(e.where=[]),this.queryObject.prefixes={},e.where.push({type:"group",patterns:[this.queryObject]}),e}}]),e}();function Mt(e){var t=new Ft(e),r=t.buildFromQueryRepresentation(),n=new qt(new _t["Generator"]);return n.getString(r)}var Ut,At=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder__add-condition"},[r("Button",{directives:[{name:"i18n",rawName:"v-i18n",value:{msg:"query-builder-add-condition"},expression:"{msg: 'query-builder-add-condition'}"}],attrs:{type:"neutral"},nativeOn:{click:function(t){return e.$emit("add-condition",t)}}})],1)},Qt=[],Gt=n["default"].extend({name:"AddCondition",components:{Button:x["Button"]}}),zt=Gt,Wt=(r("005a"),Object(b["a"])(zt,At,Qt,!1,null,"499e8a00",null)),Ht=Wt.exports,Yt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder-limit"},[r("Checkbox",{staticClass:"querybuilder-limit__checkbox",attrs:{id:"limit",checked:e.checked,label:e.$i18n("query-builder-limit-number-results-description")},on:{"update:checked":function(t){e.checked=t}}}),r("TextInput",{staticClass:"querybuilder-limit__input",attrs:{disabled:!e.checked,label:e.$i18n("query-builder-limit-number-screenreader-label"),placeholder:e.$i18n("query-builder-limit-number-placeholder"),error:e.error?{message:e.$i18n(e.error.message),type:e.error.type}:null},on:{input:e.onLimitChange},model:{value:e.limit,callback:function(t){e.limit=t},expression:"limit"}})],1)},Jt=[],Kt=10,Xt=n["default"].extend({name:"Limit",data:function(){return{error:null,limit:String(Kt)}},components:{Checkbox:x["Checkbox"],TextInput:x["TextInput"]},methods:{onLimitChange:function(e){if(""===e)return this.$store.dispatch("setLimit",void 0),void(this.error={type:"error",message:"query-builder-limit-number-error-message"});var t=Number(e);if(isNaN(t)||t<1)return this.$store.dispatch("setLimit",null),void(this.error={type:"error",message:"query-builder-limit-number-error-message"});this.error=null,this.$store.dispatch("setLimit",t)}},mounted:function(){var e;this.limit=(null===(e=this.$store.getters.limit)||void 0===e?void 0:e.toString())||String(Kt)},watch:{storeLimit:function(e){""===this.limit&&e&&(this.limit=String(e),this.error=null)}},computed:{storeLimit:function(){return this.$store.getters.limit},checked:{get:function(){return this.$store.getters.useLimit},set:function(e){this.$store.dispatch("setUseLimit",e)}}}}),Zt=Xt,er=(r("5c33"),Object(b["a"])(Zt,Yt,Jt,!1,null,null,null)),tr=er.exports,rr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"querybuilder-label-optout"},[r("Checkbox",{attrs:{id:"label-optout",checked:e.checked,label:e.$i18n("query-builder-label-opt-out")},on:{"update:checked":function(t){e.checked=t}}})],1)},nr=[],ir=n["default"].extend({name:"LabelOptout",computed:{checked:{get:function(){return this.$store.getters.omitLabels},set:function(e){this.$store.dispatch("setOmitLabels",e)}}},components:{Checkbox:x["Checkbox"]}}),ar=ir,or=(r("e648"),Object(b["a"])(ar,rr,nr,!1,null,null,null)),ur=or.exports;(function(e){e["And"]="and",e["Or"]="or"})(Ut||(Ut={}));var sr=Ut,lr=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{staticClass:"querybuilder__sharable-link"},[e._v(" "+e._s(e.$i18n("query-builder-sharable-link-text"))+" "),r("Popover",{attrs:{reactToHover:!1,position:"end"},scopedSlots:e._u([{key:"target",fn:function(){return[r("Button",{attrs:{variant:"normal",type:"neutral",iconOnly:"","aria-label":"Sharable link"},nativeOn:{click:function(t){return e.copyTextToClipboard(t)}}},[r("Icon",{attrs:{type:"link",size:"large"}})],1)]},proxy:!0},{key:"default",fn:function(){return[e._v(" "+e._s(e.$i18n("query-builder-sharable-link-message"))+" ")]},proxy:!0}])})],1)},cr=[],dr=n["default"].extend({name:"SharableLink",components:{Icon:x["Icon"],Button:x["Button"],Popover:x["Popover"]},data:function(){return{href:""}},methods:{copyTextToClipboard:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new m,n=r.serialize(e.$store.state),i=new URL(window.location.href),i.searchParams.set("query",n),e.href=i.href,t.next=7,e.shortenUrl(i.href);case 7:return t.prev=7,t.next=10,navigator.clipboard.writeText(e.href);case 10:t.next=14;break;case 12:t.prev=12,t.t0=t["catch"](7);case 14:case"end":return t.stop()}}),t,null,[[7,12]])})))()},shortenUrl:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,i,a,o,u,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(o in n={method:"POST",headers:{"Content-Type":"application/json"}},i={action:"shortenurl",format:"json",origin:"*",url:e},a=new URL("https://meta.wikimedia.beta.wmflabs.org/w/api.php"),i)a.searchParams.set(o,i[o]);return r.prev=4,r.next=7,fetch(a.toString(),n);case 7:if(u=r.sent,!u.ok){r.next=13;break}return r.next=11,u.json();case 11:s=r.sent,t.href=window.location.protocol+"//"+(s.shortenurl.shorturl||s.shortenurl.shorturlalt);case 13:r.next=17;break;case 15:r.prev=15,r.t0=r["catch"](4);case 17:case"end":return r.stop()}}),r,null,[[4,15]])})))()}}}),pr=dr,hr=(r("616c"),Object(b["a"])(pr,lr,cr,!1,null,"6ab07608",null)),mr=hr.exports,yr=n["default"].extend({name:"QueryBuilder",data:function(){return{encodedQuery:"",iframeRenderKey:0}},created:function(){this.incrementMetric("main-page-loaded")},methods:{incrementMetric:function(e){this.$store.dispatch("incrementMetric",e)},runQuery:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n,i,a,o,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("validateForm");case 2:if(e.incrementMetric("run-query-button"),!e.errors.length){t.next=5;break}return t.abrupt("return");case 5:e.encodedQuery=encodeURI(Mt(e.$store.getters.query)),r="en",n=new URLSearchParams(window.location.search),n.has("uselang")&&(r=n.get("uselang")),i="//app/query/embed.html?l="+r+"#"+e.encodedQuery.replace("%5BAUTO_LANGUAGE%5D",r+"%2Cen%2Ces%2Cfr%2Cde%2Cit%2Cru%2Cja%2Czh%2Cfa%2Car%2Cnl%2Cca%2Cel").replace("%20LIMIT","%20ORDER%20BY%20%3FitemLabel%0A%20OFFSET%200%20LIMIT"),a="https://query.wikidata.org/sparql?format=json&query="+e.encodedQuery.replace("%5BAUTO_LANGUAGE%5D",r+"%2Cen%2Ces%2Cfr%2Cde%2Cit%2Cru%2Cja%2Czh%2Cfa%2Car%2Cnl%2Cca%2Cel").replace("%20LIMIT","%20ORDER%20BY%20%3FitemLabel%0A%20OFFSET%200%20LIMIT"),o=new m,u=o.serialize(e.$store.state),window.top.postMessage({event_id:"structured-query",data:{json_url:a,web_url:i,query_json:u}},"*");case 14:case"end":return t.stop()}}),t)})))()},addCondition:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("addCondition");case 2:setTimeout((function(){document.getElementsByClassName("querybuilder__condition-wrapper--last")[0].scrollIntoView({behavior:"smooth"});var e=document.querySelectorAll(".querybuilder__condition-relation-toggle .wikit-ToggleButton");e[e.length-1].focus()}));case 3:case"end":return t.stop()}}),t)})))()},setConditionRelation:function(e,t){this.$store.dispatch("setConditionRelation",{value:e,conditionIndex:t+1})},isAboveOr:function(e){return e+1!==this.conditionRows.length&&this.conditionRows[e+1].conditionRelation===sr.Or},isBelowOr:function(e){return 0!==e&&this.conditionRows[e].conditionRelation===sr.Or}},computed:Object(l["a"])({conditionRows:function(){return this.$store.getters.conditionRows}},Object(w["d"])({errors:"errors"})),components:{Button:x["Button"],ConditionRelationToggle:V,QueryResult:Tt,QueryCondition:vt,AddCondition:Ht,Limit:tr,LabelOptout:ur,Footer:g,SharableLink:mr}}),fr=yr,br=(r("3df0"),Object(b["a"])(fr,u,s,!1,null,null,null)),vr=br.exports,gr=r("5093"),wr=r.n(gr),xr=r("262e"),kr=r("2caf"),Rr=function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"getAppLanguageCode",value:function(){var e=new URLSearchParams(window.location.search);return e.has("l")?e.get("l"):"en"}}]),e}(),Tr=function(e){Object(xr["a"])(r,e);var t=Object(kr["a"])(r);function r(){return Object(p["a"])(this,r),t.apply(this,arguments)}return Object(h["a"])(r,[{key:"getMessagesForLangCode",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://conze.pt/app/query-builder/i18n/"+t+".json");case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e["catch"](0),console.warn("The language requested could not be retrieved, falling back to English"),e.abrupt("return",Promise.resolve({}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(Rr),Ir=function(){function e(){Object(p["a"])(this,e),this.services={}}return Object(h["a"])(e,[{key:"set",value:function(e,t){this.services[e]=t}},{key:"get",value:function(e){if(void 0===this.services[e])throw new Error("".concat(e," is undefined"));return this.services[e]}}]),e}(),Or=r("9072"),Vr=function(e){Object(xr["a"])(r,e);var t=Object(kr["a"])(r);function r(){return Object(p["a"])(this,r),t.apply(this,arguments)}return r}(Object(Or["a"])(Error)),qr=function(){function e(t,r){Object(p["a"])(this,e),this.forLanguageCode=t,this.endpoint=r}return Object(h["a"])(e,[{key:"searchEntities",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r,n,i){var a,o,u,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("The parameter searchString must not be empty!");case 2:for(u in a={action:"wbsearchentities",search:t,language:this.forLanguageCode,uselang:this.forLanguageCode,type:r,format:"json",formatversion:"2",errorformat:"plaintext",origin:"*"},n&&(a.limit="".concat(n)),i&&(a.continue="".concat(i)),o=new URL(this.endpoint),a)o.searchParams.set(u,a[u]);return e.prev=7,e.next=10,fetch(o.toString());case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e["catch"](7),new Vr("Network error");case 16:if(s.ok){e.next=18;break}throw new Vr("".concat(s.status,": ").concat(s.statusText));case 18:return e.next=20,s.json();case 20:return l=e.sent,e.abrupt("return",l.search);case 22:case"end":return e.stop()}}),e,this,[[7,13]])})));function t(t,r,n,i){return e.apply(this,arguments)}return t}()},{key:"searchProperties",value:function(e,t,r){return this.searchEntities(e,"property",t,r)}},{key:"searchItemValues",value:function(e,t,r){return this.searchEntities(e,"item",t,r)}}]),e}(),_r=(r("a15b"),r("b0c0"),function(e){Object(xr["a"])(r,e);var t=Object(kr["a"])(r);function r(){var e;return Object(p["a"])(this,r),e=t.call(this),e.message="Precision not supported. Supported precisions: years, months, days",e.name="PrecisionError",e}return r}(Object(Or["a"])(Error))),Pr=function(){function e(t){Object(p["a"])(this,e),this.endpoint=t}return Object(h["a"])(e,[{key:"parseValues",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r){var n,i,a,o,u,s,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("The parameter values must not be empty!");case 2:if(!(t.length>1)){e.next=4;break}throw new Error("only one value is supported.");case 4:if(r){e.next=6;break}throw new Error("The parameter datatype must not be empty!");case 6:for(o in n=t.join("|"),i={action:"wbparsevalue",values:n,datatype:r,validate:"true",format:"json",formatversion:"2",errorformat:"plaintext",origin:"*"},a=new URL(this.endpoint),i)a.searchParams.set(o,i[o]);return e.prev=10,e.next=13,fetch(a.toString());case 13:u=e.sent,e.next=19;break;case 16:throw e.prev=16,e.t0=e["catch"](10),new Vr("Network error");case 19:if(u.ok){e.next=21;break}throw new Vr("".concat(u.status,": ").concat(u.statusText));case 21:return e.next=23,u.json();case 23:if(s=e.sent,!s.errors){e.next=26;break}throw new Vr(this.extractPlaintextErrorMessageFromData(s));case 26:if(l=s.results,!(l[0].value&&l[0].value.precision<9)){e.next=29;break}throw new _r;case 29:return e.abrupt("return",l);case 30:case"end":return e.stop()}}),e,this,[[10,16]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"extractPlaintextErrorMessageFromData",value:function(e){return"wikibase-parse-error-time"===e.errors[0].code?e.errors[0].text:"".concat(e.errors[0].code,": ").concat(e.errors[0].text)}}]),e}(),Cr=function(){function e(t,r){Object(p["a"])(this,e),this.forLanguageCode=t,this.endpoint=r}return Object(h["a"])(e,[{key:"formatValue",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t,r){var n,i,a,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(a in n={action:"wbformatvalue",generate:"text/plain",datavalue:JSON.stringify(t),property:r,uselang:this.forLanguageCode,options:JSON.stringify({lang:this.forLanguageCode}),format:"json",formatversion:"2",errorformat:"plaintext",origin:"*"},i=new URL(this.endpoint),n)i.searchParams.set(a,n[a]);return e.prev=3,e.next=6,fetch(i.toString());case 6:o=e.sent,e.next=12;break;case 9:throw e.prev=9,e.t0=e["catch"](3),new Vr("Network error");case 12:if(o.ok){e.next=14;break}throw new Vr("".concat(o.status,": ").concat(o.statusText));case 14:return e.next=16,o.json();case 16:if(u=e.sent,!u.error){e.next=19;break}throw new Vr("".concat(u.error.code,": ").concat(u.error.info));case 19:return e.abrupt("return",u.result);case 20:case"end":return e.stop()}}),e,this,[[3,9]])})));function t(t,r){return e.apply(this,arguments)}return t}()}]),e}(),jr=function(){function e(t,r){Object(p["a"])(this,e),this.prefix=t,this.endpoint=r}return Object(h["a"])(e,[{key:"increment",value:function(t){this.endpoint&&e.sendBacon(this.endpoint+"?"+this.prefix+"."+t+"=1c")}}],[{key:"sendBacon",value:function(e){if(navigator.sendBeacon)try{navigator.sendBeacon(e)}catch(t){}else document.createElement("img").src=e}}]),e}(),Br=new Ir,Er=new Tr;Br.set("languageService",Er),Br.set("searchEntityRepository",new qr(Er.getAppLanguageCode(),"https://www.wikidata.org/w/api.php")),Br.set("parseValueRepository",new Pr("https://www.wikidata.org/w/api.php")),Br.set("formatValueRepository",new Cr(Er.getAppLanguageCode(),"https://www.wikidata.org/w/api.php")),Br.set("metricsCollector",new jr("Wikidata.query-builder",""));var Sr=Br;n["default"].config.errorHandler=function(){Sr.get("metricsCollector").increment("errors")};var Lr=Sr.get("languageService"),Dr=n["default"].extend({data:function(){return{isi18nLoaded:!1,lang:Lr.getAppLanguageCode(),textDirection:""}},created:function(){this.fetchi18n(),this.reconstructStateFromURL()},updated:function(){var e=document.getElementById("directionSample");e&&(this.textDirection=getComputedStyle(e).direction)},methods:{fetchi18n:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Lr.getMessagesForLangCode("en");case 2:if(t.t0=t.sent,r={en:t.t0},"en"===e.lang){t.next=8;break}return t.next=7,Lr.getMessagesForLangCode(e.lang);case 7:r[e.lang]=t.sent;case 8:n["default"].use(wr.a,{locale:e.lang,messages:r,wikilinks:!0}),e.isi18nLoaded=!0;case 10:case"end":return t.stop()}}),t)})))()},reconstructStateFromURL:function(){var e=new URLSearchParams(window.location.search);e.has("query")&&this.$store.dispatch("parseState",e.get("query"))}},name:"App",components:{QueryBuilder:vr}}),$r=Dr,Nr=Object(b["a"])($r,i,a,!1,null,null,null),Fr=Nr.exports,Mr=["string","external-id","wikibase-item","quantity","time"],Ur=Mr,Ar=(r("45fc"),function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"validateValue",value:function(t){return t?null:e.VALUE_MISSING_ERROR}}]),e}());Ar.VALUE_MISSING_ERROR={message:"query-builder-result-error-missing-value",type:"error"};var Qr=function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"validateValue",value:function(e){return e&&(e.parseResult||e.formattedValue)?!e.parseResult&&e.formattedValue?{type:"error",message:e.formattedValue}:null:Ar.VALUE_MISSING_ERROR}}]),e}(),Gr=function(){function e(t){Object(p["a"])(this,e),this.formValues=t}return Object(h["a"])(e,[{key:"validate",value:function(){var e=this,t={formErrors:[],fieldErrors:[]};return this.isEmpty()?(t.formErrors.push({message:"query-builder-result-error-empty-form",type:"notice"}),t.fieldErrors.push({property:null,value:null}),t):(t.fieldErrors=this.formValues.map((function(t){return e.validateCondition(t)})),t.fieldErrors.some((function(e){var t=e.property,r=e.value;return null!==t||null!==r}))&&t.formErrors.push({message:"query-builder-result-error-incomplete-form",type:"error"}),t)}},{key:"validateCondition",value:function(e){var t,r={property:null,value:null};return null!==(t=e.property)&&void 0!==t&&t.id||(r.property={message:"query-builder-result-error-missing-property",type:"error"}),r.value=this.validateConditionValue(e.property,e.propertyValueRelation,e.value),r}},{key:"validateConditionValue",value:function(e,t,r){if(t===Ue.Regardless)return null;if(!e)return(new Ar).validateValue(r);switch(e.datatype){case"time":return(new Qr).validateValue(r);case"quantity":return(new ue).validateQuantityValue(r);default:return(new Ar).validateValue(r)}}},{key:"isEmpty",value:function(){var e;return 0===this.formValues.length||1===this.formValues.length&&!(null!==(e=this.formValues[0].property)&&void 0!==e&&e.id)&&!this.formValues[0].value}}]),e}(),zr=function(e){Object(xr["a"])(r,e);var t=Object(kr["a"])(r);function r(){return Object(p["a"])(this,r),t.apply(this,arguments)}return r}(Object(Or["a"])(Error)),Wr=function(){function e(){Object(p["a"])(this,e)}return Object(h["a"])(e,[{key:"deserialize",value:function(e){var t,r=this;try{t=JSON.parse(e)}catch(a){throw new zr("query URL parameter is not valid JSON")}var n=[],i=1;try{return t.conditions.forEach((function(e){n.push({propertyData:r.getPropertyData(e),valueData:{value:r.getConditionValue(e),valueError:null},propertyValueRelationData:{value:e.propertyValueRelation},referenceRelation:e.referenceRelation,subclasses:e.subclasses,conditionRelation:e.conditionRelation,negate:e.negate,conditionId:i.toString()}),i++})),{conditionRows:n,useLimit:t.useLimit,limit:t.limit,errors:[],omitLabels:t.omitLabels}}catch(a){throw new zr("invalid query URL parameter")}}},{key:"getPropertyData",value:function(e){return{id:e.propertyId,label:e.propertyId,datatype:e.propertyDataType,isPropertySet:""!==e.propertyId,propertyError:null}}},{key:"getConditionValue",value:function(e){return""===e.value||null===e.value?null:this.isQuantityValue(e,e.value)?{value:e.value.value,unit:e.value.unit?{id:e.value.unit,label:e.value.unit}:null,rawUnitInput:""}:this.isDateValue(e,e.value)?{parseResult:{value:{time:e.value.value,after:0,before:0,calendarmodel:"",precision:e.value.precision,timezone:0},type:"time"},formattedValue:e.value.value,precision:e.value.precision}:"wikibase-item"===e.propertyDataType?{id:e.value,label:e.value}:e.value}},{key:"isQuantityValue",value:function(e,t){return"quantity"===e.propertyDataType}},{key:"isDateValue",value:function(e,t){return"time"===e.propertyDataType}}]),e}(),Hr=function(e,t,r,n){return{searchProperties:function(t,r){return Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.searchProperties(r.search,r.limit,r.offset);case 2:return n=t.sent,t.abrupt("return",n.map((function(e){return Ur.includes(e.datatype)||(e.tag="query-builder-property-lookup-limited-support-tag"),e})));case 4:case"end":return t.stop()}}),t)})))()},searchItemValues:function(t,r){return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.searchItemValues(r.search,r.limit,r.offset);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))()},updateDateValue:function(e,t){return Object(o["a"])(regeneratorRuntime.mark((function i(){var a,o,u,s,l,c,d;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return e.commit("clearValue",t.conditionIndex),e.commit("clearFieldErrors",{conditionIndex:t.conditionIndex,errorsToClear:"value"}),i.prev=2,i.next=5,r.parseValues([t.rawInput],"time");case 5:o=i.sent,u=Object(It["a"])(o,1),a=u[0],i.next=16;break;case 10:return i.prev=10,i.t0=i["catch"](2),s={parseResult:null,formattedValue:i.t0.message},e.commit("setValue",{value:s,conditionIndex:t.conditionIndex}),e.commit("setFieldErrors",{index:t.conditionIndex,errors:{valueError:{type:"error",message:i.t0.message}}}),i.abrupt("return");case 16:return l=e.getters.property(t.conditionIndex).id,i.next=19,n.formatValue(a,l);case 19:c=i.sent,d={parseResult:a,formattedValue:c},e.commit("setValue",{value:d,conditionIndex:t.conditionIndex});case 22:case"end":return i.stop()}}),i,null,[[2,10]])})))()},updateValue:function(e,t){e.commit("clearFieldErrors",{conditionIndex:t.conditionIndex,errorsToClear:"value"});var r=e.getters.datatype(t.conditionIndex);"time"===r&&t.value?e.dispatch("updateDateValue",{rawInput:t.value,conditionIndex:t.conditionIndex}):e.commit("setValue",t)},unsetProperty:function(e,t){e.commit("unsetProperty",t),e.commit("clearFieldErrors",{conditionIndex:t,errorsToClear:"property"})},updateProperty:function(e,t){var r=e.getters.datatype(t.conditionIndex);r&&r!==t.property.datatype&&e.commit("clearValue",t.conditionIndex),e.commit("setProperty",t),Ur.includes(t.property.datatype)?e.commit("clearFieldErrors",{conditionIndex:t.conditionIndex,errorsToClear:"property"}):e.dispatch("setConditionAsLimitedSupport",t.conditionIndex)},updatePropertyValueRelation:function(e,t){e.commit("setPropertyValueRelation",t)},setReferenceRelation:function(e,t){e.commit("setReferenceRelation",t)},setNegate:function(e,t){e.commit("setNegate",t)},setLimit:function(e,t){e.commit("setLimit",t)},setUseLimit:function(e,t){e.commit("setUseLimit",t)},setOmitLabels:function(e,t){e.commit("setOmitLabels",t)},setSubclasses:function(e,t){e.commit("setSubclasses",t)},setConditionRelation:function(e,t){e.commit("setConditionRelation",t)},setErrors:function(e,t){e.commit("setErrors",t)},incrementMetric:function(e,r){t.increment(r)},addCondition:function(e){e.commit("addCondition")},removeCondition:function(e,t){e.commit("removeCondition",t)},setConditionAsLimitedSupport:function(e,t){e.dispatch("updatePropertyValueRelation",{propertyValueRelation:Ue.Regardless,conditionIndex:t}),e.dispatch("updateValue",{value:null,conditionIndex:t}),e.commit("setFieldErrors",{index:t,errors:{propertyError:{type:"warning",message:"query-builder-property-lookup-limited-support-note"}}})},validateForm:function(e){var t=new Gr(e.rootState.conditionRows.map((function(e){return{property:e.propertyData.isPropertySet?e.propertyData:null,value:e.valueData.value,propertyValueRelation:e.propertyValueRelationData.value}}))),r=t.validate();e.commit("setErrors",r.formErrors),r.fieldErrors.forEach((function(t,r){e.commit("setFieldErrors",{index:r,errors:{propertyError:t.property,valueError:t.value}})})),e.rootState.conditionRows.forEach((function(t,r){var n,i=null===(n=t.propertyData)||void 0===n?void 0:n.datatype;i&&!Ur.includes(i)&&e.dispatch("setConditionAsLimitedSupport",r)})),e.dispatch("validateLimit")},validateLimit:function(e){void 0!==e.rootState.limit?e.rootState.useLimit&&null===e.rootState.limit&&e.commit("setErrors",[{type:"error",message:"query-builder-result-error-incomplete-form"}]):e.commit("setLimit",Kt)},parseState:function(e,t){var r=new Wr;try{var n=r.deserialize(t);e.commit("setState",n)}catch(i){}}}},Yr=(r("a434"),{setValue:function(e,t){e.conditionRows[t.conditionIndex].valueData.value=t.value},clearValue:function(e,t){e.conditionRows[t].valueData.value=null},setProperty:function(e,t){e.conditionRows[t.conditionIndex].propertyData=Object(l["a"])(Object(l["a"])({},e.conditionRows[t.conditionIndex].propertyData),t.property),e.conditionRows[t.conditionIndex].propertyData.isPropertySet=!0},setNegate:function(e,t){e.conditionRows[t.conditionIndex].negate=t.value},unsetProperty:function(e,t){e.conditionRows[t].propertyData.isPropertySet=!1},setPropertyValueRelation:function(e,t){e.conditionRows[t.conditionIndex].propertyValueRelationData.value=t.propertyValueRelation},setReferenceRelation:function(e,t){e.conditionRows[t.conditionIndex].referenceRelation=t.referenceRelation},setLimit:function(e,t){e.limit=t},setUseLimit:function(e,t){e.useLimit=t},setOmitLabels:function(e,t){e.omitLabels=t},setSubclasses:function(e,t){e.conditionRows[t.conditionIndex].subclasses=t.subclasses},setConditionRelation:function(e,t){e.conditionRows[t.conditionIndex].conditionRelation=t.value},setErrors:function(e,t){e.errors=t},addCondition:function(e){e.conditionRows.push(Zr(0===e.conditionRows.length))},removeCondition:function(e,t){e.conditionRows.splice(t,1),1===e.conditionRows.length&&(e.conditionRows[0].conditionRelation=null)},setFieldErrors:function(e,t){void 0!==t.errors.propertyError&&(e.conditionRows[t.index].propertyData.propertyError=t.errors.propertyError),void 0!==t.errors.valueError&&(e.conditionRows[t.index].valueData.valueError=t.errors.valueError)},clearFieldErrors:function(e,t){"property"!==t.errorsToClear&&"both"!==t.errorsToClear||(e.conditionRows[t.conditionIndex].propertyData.propertyError=null),"value"!==t.errorsToClear&&"both"!==t.errorsToClear||(e.conditionRows[t.conditionIndex].valueData.valueError=null)},setState:function(e,t){Object.assign(e,t)}});function Jr(e,t){if(null===t)return"";if("wikibase-item"===e)return t.id;var r;if("quantity"===e)return{value:t.value,unit:(null===(r=t.unit)||void 0===r?void 0:r.id)||null};if("time"===e){var n=t;if(null===n.parseResult)throw new st.a("invalid time value");return{value:n.parseResult.value.time,precision:n.parseResult.value.precision}}return t}var Kr={query:function(e){var t;return Object(l["a"])(Object(l["a"])({conditions:e.conditionRows.map((function(e){if(null===e.propertyData.datatype)throw new st.a("missing datatype!");return{propertyId:e.propertyData.id,value:Jr(e.propertyData.datatype,e.valueData.value),referenceRelation:e.referenceRelation,propertyValueRelation:e.propertyValueRelationData.value,datatype:e.propertyData.datatype,subclasses:e.subclasses,conditionRelation:e.conditionRelation,negate:e.negate}}))},e.useLimit&&{limit:null!==(t=e.limit)&&void 0!==t?t:Kt}),{},{omitLabels:e.omitLabels})},conditionRows:function(e){return e.conditionRows},property:function(e){return function(t){var r;return null!==(r=e.conditionRows[t].propertyData)&&void 0!==r&&r.id?e.conditionRows[t].propertyData:null}},propertyError:function(e){return function(t){return e.conditionRows[t].propertyData.propertyError}},datatype:function(e){return function(t){return e.conditionRows[t].propertyData.datatype}},limitedSupport:function(e){return function(t){if(!e.conditionRows[t].propertyData.isPropertySet)return!1;var r=e.conditionRows[t].propertyData.datatype;return null!==r&&!Ur.includes(r)}},value:function(e){return function(t){return e.conditionRows[t].valueData.value}},valueError:function(e){return function(t){return e.conditionRows[t].valueData.valueError}},propertyValueRelation:function(e){return function(t){return e.conditionRows[t].propertyValueRelationData.value}},referenceRelation:function(e){return function(t){return e.conditionRows[t].referenceRelation}},negate:function(e){return function(t){return e.conditionRows[t].negate}},limit:function(e){return e.limit},useLimit:function(e){return e.useLimit},omitLabels:function(e){return e.omitLabels},subclasses:function(e){return function(t){return e.conditionRows[t].subclasses}},conditionRelation:function(e){return function(t){return e.conditionRows[t].conditionRelation}},getErrors:function(e){return e.errors}};function Xr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{label:"",id:"",datatype:null,isPropertySet:!1,propertyError:e}}function Zr(e){return{propertyData:Xr(),valueData:{value:null,valueError:null},propertyValueRelationData:{value:Ue.Matching},referenceRelation:rt.Regardless,subclasses:!1,negate:!1,conditionRelation:e?null:sr.And,conditionId:"condition-id-".concat(Math.random())}}function en(){return{conditionRows:[Zr(!0)],errors:[],limit:10,useLimit:!0,omitLabels:!1}}function tn(e){return new w["a"]({state:en(),actions:Hr(e.get("searchEntityRepository"),e.get("metricsCollector"),e.get("parseValueRepository"),e.get("formatValueRepository")),mutations:Yr,getters:Kr,modules:{}})}n["default"].use(w["b"]),n["default"].config.productionTip=!1,new n["default"]({store:tn(Sr),render:function(e){return e(Fr)}}).$mount("#app")},e343:function(e,t,r){},e648:function(e,t,r){"use strict";r("c144")},f13c:function(e,t){},f643:function(e,t,r){}});
