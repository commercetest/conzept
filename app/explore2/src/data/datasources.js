const datasources = {

  'wikipedia': {
    active:                 false,
    name:                   'Wikipedia',
    set:                    'reference',
    description:            'encyclopedic topics',
    tag:                    'general',
    qid:                    'Q52',
    protocol:               'rest',
    endpoint:               'wikipedia.org/w/api.php',
    format:                 'json',
    connect:                'jsonp',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // https://www.mediawiki.org/wiki/Help:CirrusSearch
                              'none'            : 'relevance',
                              'relevance-desc'  : 'relevance',
                              'relevance-asc'   : 'random',
                              'date-desc'       : 'create_timestamp_asc',
                              'date-asc'        : 'create_timestamp_desc',
                              'update-desc'     : 'last_edit_desc',
                              'update-asc'      : 'last_edit_asc',
                              'random'          : 'random',
                              'citations-desc'  : 'incoming_links_desc',
                              'citations-asc'   : 'incoming_links_asc',
                              'title-desc'      : 'just_match',
                              'title-asc'       : 'just_match',
                              'distance-desc'   : 'relevance', // see: https://www.mediawiki.org/wiki/Help:CirrusSearch#Geo_Search
                              'distance-asc'    : 'relevance', //   example: "nearcoord:42km,37.77666667,-122.39"
                            },
    media:                  [ 'text' ],
    filter_map:             { // https://www.mediawiki.org/wiki/Help:CirrusSearch#Filters
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    // Wikipedia API:
    //  https://www.mediawiki.org/wiki/API:Main_page
    //  https://www.mediawiki.org/wiki/Help:CirrusSearch#Geo_Search
    url:                    'https://${explore.language}.${datasources.wikipedia.endpoint}?action=query&format=${datasources.wikipedia.format}&srsearch=${term}&srnamespace=0|14&srlimit=${datasources.wikipedia.pagesize}&srsort=${ valid( sortby )? sortby : "relevance" }&list=search&continue=-||&sroffset=${ (explore.page -1) * datasources.wikipedia.pagesize}',
    //url:                    'https://${explore.language}.${datasources.wikipedia.endpoint}?action=query&format=${datasources.wikipedia.format}&srsearch=${term}&srnamespace=0|14&srlimit=${datasources.wikipedia.pagesize}&srsort=${ valid( sortby )? sortby : "relevance" }&list=search&continue=-||&sroffset=${ (explore.page -1) * datasources.wikipedia.pagesize}&${ valid( [ geofilter_lat, geofilter_lon, geofilter_radius ] )? "srsearch=nearcoord%3A" + geofilter_radius / 1000 + "km%2C" + geofilter_lat + "%2C" + geofilter_lon : "" }',
    // SORTING: 
    icon:                   '<i class="fa-brands fa-wikipedia-w"></i>',
    color:                  '#00B1BB', // '#c8ccd16b',
    icon_invert:            false,
    display_url:            'https://${explore.host}${explore.base}/app/wikipedia/?q=${qid}&lang=${language}', // TODO
    code_data_collect:      'my_promises.push( processResultsWikipedia( topicResults, struct, index ) );', // FIXME: invert control (see next line)
    //code_data_collect:    'processResultsWikipedia( my_promises, topicResults, struct, index );',
    code_autocomplete:      'autocompleteWikipedia( r, dataset )',
    code_resolve:           'resolveWikipedia( result, renderObject )',
    code_render_mark:       'renderMarkWikipedia( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'opensearch',
    autocomplete_url:       'https://${explore.language}.wikipedia.org/w/api.php?action=${datasources.wikipedia.autocomplete_protocol}&format=${datasources.wikipedia.autocomplete_format}&search=${term}&namespace=${datasources.wikipedia.autocomplete_filter}&srsort=${ valid( sortby )? sortby : "relevance" }&limit=${datasources.wikipedia.autocomplete_limit}&profile=${datasources.wikipedia.autocomplete_mode}',
    autocomplete_format:    'json',
    autocomplete_connect:   'jsonp',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
    autocomplete_filter:    '0|14', // Wikipedia-API specific: list of Wikipedia namespaces
    autocomplete_mode:      'fuzzy',
  },

  'wikidata': {
    active:                 false,
    name:                   'Wikidata',
    set:                    'reference',
    description:            'knowledge base topics',
    tag:                    'general',
    qid:                    'Q2013',
    protocol:               'sparql',
    endpoint:               'https://query.wikidata.org/sparql',
    format:                 'json',
    connect:                'json',
    //pagesize:               5, // FIXME: use datasource_page_size, // NOTE: sync this value with "structured query builder"!
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text' ],
    filter_map:             { // https://www.mediawiki.org/wiki/Help:CirrusSearch#Filters
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              '3D'              : '',
                              'data'            : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },

    count_url:              '${datasources.wikidata.endpoint}?format=${datasources.wikidata.format}&query=SELECT (COUNT(*) AS ?count) WHERE { hint:Query hint:optimizer "None".  VALUES ?searchTerm { "${term.replace( /"/gm, "" )}" } ${ valid( [ geofilter_lat, geofilter_lon, geofilter_radius ] )? "SERVICE wikibase:around \{ ?item wdt:P625 ?location . bd:serviceParam wikibase:center %22Point(" + geofilter_lon + " " + geofilter_lat + ")%22^^geo:wktLiteral .  bd:serviceParam wikibase:radius %22" + geofilter_radius / 1000 + "%22 . \}" : " " } SERVICE wikibase:mwapi { bd:serviceParam wikibase:api "EntitySearch". bd:serviceParam wikibase:endpoint "www.wikidata.org".  bd:serviceParam mwapi:search ?searchTerm.  bd:serviceParam mwapi:language "${explore.language}".  ?item wikibase:apiOutputItem mwapi:item.  } ${ setWikidataQueryFilter() } SERVICE wikibase:label { bd:serviceParam wikibase:language "${explore.language}". } }',

    url:                    '${datasources.wikidata.endpoint}?format=${datasources.wikidata.format}&query=SELECT ?item ?itemLabel WHERE { hint:Query hint:optimizer "None".  VALUES ?searchTerm { "${term.replace( /"/gm, "" )}" } ${ valid( [ geofilter_lat, geofilter_lon, geofilter_radius ] )? "SERVICE wikibase:around \{ ?item wdt:P625 ?location . bd:serviceParam wikibase:center %22Point(" + geofilter_lon + " " + geofilter_lat + ")%22^^geo:wktLiteral .  bd:serviceParam wikibase:radius %22" + geofilter_radius / 1000 + "%22 . \}" : " " } SERVICE wikibase:mwapi { bd:serviceParam wikibase:api "EntitySearch".  bd:serviceParam wikibase:endpoint "www.wikidata.org".  bd:serviceParam mwapi:search ?searchTerm.  bd:serviceParam mwapi:language "${explore.language}".  ?item wikibase:apiOutputItem mwapi:item.  } ${ setWikidataQueryFilter() } SERVICE wikibase:label { bd:serviceParam wikibase:language "${explore.language}". } } OFFSET ${ (explore.page -1) * datasources.wikidata.pagesize } LIMIT ${datasources.wikidata.pagesize}',

    //count_url:              '${datasources.wikidata.endpoint}?format=${datasources.wikidata.format}&query=SELECT (COUNT(*) AS ?count) WHERE { hint:Query hint:optimizer "None".  VALUES ?searchTerm { "${term.replace( /"/gm, "" )}" } SERVICE wikibase:mwapi { bd:serviceParam wikibase:api "EntitySearch".  bd:serviceParam wikibase:endpoint "www.wikidata.org".  bd:serviceParam mwapi:search ?searchTerm.  bd:serviceParam mwapi:language "${explore.language}".  ?item wikibase:apiOutputItem mwapi:item.  } ${ setWikidataQueryFilter() } SERVICE wikibase:label { bd:serviceParam wikibase:language "${explore.language}". } }',
    //url:                    '${datasources.wikidata.endpoint}?format=${datasources.wikidata.format}&query=SELECT ?item ?itemLabel WHERE { hint:Query hint:optimizer "None".  VALUES ?searchTerm { "${term.replace( /"/gm, "" )}" } SERVICE wikibase:mwapi { bd:serviceParam wikibase:api "EntitySearch".  bd:serviceParam wikibase:endpoint "www.wikidata.org".  bd:serviceParam mwapi:search ?searchTerm.  bd:serviceParam mwapi:language "${explore.language}".  ?item wikibase:apiOutputItem mwapi:item.  } ${ setWikidataQueryFilter() } SERVICE wikibase:label { bd:serviceParam wikibase:language "${explore.language}". } } OFFSET ${ (explore.page -1) * datasources.wikidata.pagesize } LIMIT ${datasources.wikidata.pagesize}',
    icon:                   '<img class="datasource-icon" alt="Wikidata datasource" src="/assets/icons/wikidata.png"></img>',
    icon_invert:            false,
    color:                  '#990000',
    display_url:            'https://${explore.host}${explore.base}/app/wikidata/?q=${qid}&lang=${language}',
    code_autocomplete:      'autocompleteWikidata( r, dataset )',
    code_data_collect:      'processResultsWikidata( my_promises, topicResults, struct, index );',
    code_resolve:           'resolveWikidata( result, renderObject )',
    code_count:             'countWikidata( r, struct, index )',
    code_render_mark:       'renderMarkWikidata( inputs, source, q_, show_raw_results, id )',
    instance:               'https://www.wikidata.org',             // Wikibase specific
    instance_api:           'https://www.wikidata.org/w/api.php',   // Wikibase specific
    autocomplete_active:    true,
    autocomplete_protocol:  'sparql',
    autocomplete_url:       '${datasources.wikidata.endpoint}?format=${datasources.wikidata.autocomplete_format}&query=SELECT DISTINCT ?item ?itemLabel { hint:Query hint:optimizer "None".  VALUES ?searchTerm { "${term.replace( /"/gm, "" )}" } SERVICE wikibase:mwapi { bd:serviceParam wikibase:api "EntitySearch".  bd:serviceParam wikibase:endpoint "www.wikidata.org".  bd:serviceParam wikibase:limit ${datasources.wikidata.autocomplete_limit} .  bd:serviceParam mwapi:search ?searchTerm.  bd:serviceParam mwapi:language "${explore.language}".  ?item wikibase:apiOutputItem mwapi:item. ?num wikibase:apiOrdinal true.  } ?item (wdt:P279|wdt:P31) ?type. ${ setWikidataQueryFilter() } SERVICE wikibase:label { bd:serviceParam wikibase:language "${explore.language}". } } ORDER BY ?searchTerm ?num',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
    autocomplete_mode:      '',
  },

  'commons': {
    active:                 false,
    name:                   'Wikimedia Commons',
    set:                    'culture',
    description:            'media library',
    tag:                    'arts-culture',
    qid:                    'Q565',
    protocol:               'rest',
    endpoint:               'https://commons.wikimedia.org/w/api.php',// see: https://commons.wikimedia.org/w/api.php
                                                                      //      https://commons.wikimedia.org/w/api.php?action=help&modules=query
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {  // no sort available?
                                // https://phabricator.wikimedia.org/T219576
                                // https://www.mediawiki.org/wiki/Help:CirrusSearch
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
                            // https://commons.wikimedia.org/wiki/Special:MediaStatistics
    media:                  [ 'text', 'image', 'video', 'audio', 'software', 'archive' ],
    filter_map:             { // https://www.mediawiki.org/wiki/Help:CirrusSearch#File_properties_search
                              'none'            : '',
                              'text'            : 'text|office',
                              'image'           : 'bitmap|drawing',
                              'video'           : 'video',
                              'audio'           : 'audio',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : 'executable',
                              'archive'         : 'archive',
                              'entity'          : '',
                            },
                            // https://commons.wikimedia.org/w/api.php?action=query&cirrusDumpResult=true&format=json&generator=search&gsrlimit=4&gsrnamespace=6&gsroffset=0&gsrsearch=filetype:bitmap|drawing%20-fileres:0%20custommatch:depicts_or_linked_from=Q152&origin=*
    url:                    '${datasources.commons.endpoint}?action=query&cirrusDumpResult=true&format=json&generator=search&gsrlimit=${datasources.commons.pagesize - 1 }&gsrnamespace=6&gsroffset=${ (explore.page -1) * ( datasources.commons.pagesize ) }&gsrsearch=${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "filetype:" + filterby  : "filetype:bitmap|drawing|video|audio|text|executable|archive" }%20-fileres:0%20custommatch:depicts_or_linked_from=${ valid( explore.q_qid ) ? explore.q_qid : "Q0" }&origin=*',
    icon:                   '<img class="datasource-icon" alt="Wikimedia Commons datasource" src="/assets/icons/commons.svg" alt="Wikimedia Commons logo">',
    icon_invert:            false,
    color:                  '#069',
    display_url:            'https://commons.wikimedia.org/wiki/File:${ file }',
    code_autocomplete:      'autocompleteCommons( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsCommons( topicResults, struct, index ) );',
    code_resolve:           'resolveCommons( result, renderObject )',
    code_render_mark:       'renderMarkCommons( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    false, // TODO?
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.commons.endpoint}/suggest?q=${term}&limit=${datasources.commons.autocomplete_limit}&offset=0',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'archive': {
    active:                 false,
    name:                   'Internet Archive',
    set:                    'culture',
    description:            'media library',
    tag:                    'arts-culture',
    qid:                    'Q461',
    protocol:               'rest',
    endpoint:               'https://archive.org/advancedsearch.php',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // see: https://archive.org/advancedsearch.php
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'publicdate+desc',
                              'date-asc'        : 'publicdate+asc',
                              'update-desc'     : 'updatedate+desc',
                              'update-asc'      : 'updatedate+asc',
                              'random'          : 'random+asc',
                              'citations-desc'  : 'item_count+desc',  // files_count+desc
                              'citations-asc'   : 'item_count+asc',   // files_count+asc
                              'title-desc'      : 'titleSorter+desc',
                              'title-asc'       : 'titleSorter+asc',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text', 'image', 'video', 'audio', 'data', 'software', 'archive' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : 'texts',
                              'image'           : 'image',
                              'video'           : 'movies',
                              'audio'           : 'audio',
                              'data'            : 'data',
                              '3D'              : '',
                              'software'        : 'software',
                              'archive'         : 'web',
                              'entity'          : '',
                            },
    url:                    '${datasources.archive.endpoint}?sort[]=${ valid( sortby )? sortby : "" }&rows=${datasources.archive.pagesize}&output=json&page=${explore.page}&language%3A"${ wp_languages[ explore.language ].name }"&q=${term}${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "+AND+mediatype%3A(" + filterby + ")" : "" }',
    icon:                   '<img class="datasource-icon" alt="Internet Archive datasource" src="/assets/icons/archive.svg" alt="Internet Archive logo">',
    icon_invert:            true,
    color:                  '#333',
    display_url:            'https://archive.org/details/${gid}/?q=${ setQuotes( term ) }&autoplay=1',
    // TODO: search_url:    'https://archive.org/search?query=${term}&language%3A"${ wp_languages[ explore.language ].name }"',
    code_autocomplete:      'autocompleteArchive( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsArchive( topicResults, struct, index ) );',
    code_resolve:           'resolveArchive( result, renderObject )',
    code_render_mark:       'renderMarkArchive( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.archive.endpoint}?sort[]=${ valid( sortby )? sortby : "" }&rows=${datasources.archive.autocomplete_limit}&output=json&page=1&language%3A"${ wp_languages[ explore.language ].name }"&fl[]=title&q=%22${term}%22${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "+AND+mediatype%3A(" + filterby + ")" : "" }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'openlibrary': {
    active:                 false,
    name:                   'Open Library',
    set:                    'culture',
    description:            'books library',
    tag:                    'arts-culture',
    qid:                    'Q1201876',
    protocol:               'rest',
    endpoint:               'https://openlibrary.org/search.json',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // see: https://openlibrary.org/dev/docs/api/search
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'new',
                              'date-asc'        : 'old',
                              'update-desc'     : 'new',
                              'update-asc'      : 'old',
                              'random'          : 'random',
                              'citations-desc'  : 'rating',
                              'citations-asc'   : 'rating%20desc',
                              'title-desc'      : '',
                              'title-asc'       : 'title',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.openlibrary.endpoint}?q=${term}&lang=${explore.language}&page=${explore.page}&limit=${datasources.openlibrary.pagesize}&sort=${ valid( sortby )? sortby : "" }${ valid( [ datemin, datemax ] )? "&first_publish_year=" + datemin.split("-")[0] : "" }',
    icon:                   '<img class="datasource-icon" alt="Open Library datasource" src="/assets/icons/openlibrary.svg" alt="Open Library logo">',
    icon_invert:            true,
    color:                  '#e1dcc5',
    display_url:            '',
    code_autocomplete:      'autocompleteOpenLibrary( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsOpenLibrary( topicResults, struct, index ) );',
    code_resolve:           'resolveOpenLibrary( result, renderObject )',
    code_render_mark:       'renderMarkOpenLibrary( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.openlibrary.endpoint}?q=${term}&lang=${explore.language}&page=1&limit=${datasources.openlibrary.autocomplete_limit}&sort=${ valid( sortby )? sortby : "" }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'europeana': {
    active:                 false,
    name:                   'Europeana',
    set:                    'culture',
    description:            '🇪🇺 European media library',
    tag:                    'arts-culture',
    qid:                    'Q461',
    protocol:               'rest',
    endpoint:               'https://api.europeana.eu', // see: https://pro.europeana.eu/page/search
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'score+desc',
                              'relevance-desc'  : 'score+desc',
                              'relevance-asc'   : 'score+asc',
                              'date-desc'       : 'timestamp_created+desc',
                              'date-asc'        : 'timestamp_created+asc',
                              'update-desc'     : 'timestamp_update+desc',
                              'update-asc'      : 'timestamp_update+asc',
                              'random'          : 'random+asc',
                              'citations-desc'  : 'score+desc',
                              'citations-asc'   : 'score+desc',
                              'title-desc'      : 'score+desc',
                              'title-asc'       : 'score+desc',
                              'distance-desc'   : 'score+desc', // TO RESEARCH: geo-tag: https://pro.europeana.eu/page/annotations
                              'distance-asc'    : 'score+desc',
                            },
    media:                  [ 'text', 'image', 'video', 'audio', '3D' ],
    filter_map:             { // https://pro.europeana.eu/page/intro
                              'none'            : '',
                              'text'            : 'text',
                              'image'           : 'image',
                              'video'           : 'video',
                              'audio'           : 'sound',
                              'data'            : '',
                              '3D'              : '3D',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.europeana.endpoint}/record/search.json?wskey=4ZViVZKMe&view=grid&query=${term}&media=true&sort=${ valid( sortby )? sortby : "score+desc" }&profile=standard&rows=${datasources.europeana.pagesize}&start=${ ( (explore.page -1) * datasources.europeana.pagesize ) + 1 }&${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "qf=" + filterby : "qf=" }${ valid( [ datemin, datemax ] )? "&qf=timestamp_created:%5B" + datemin + "+TO+" + datemax + "%5D" : "" }',
                            // TODO: add additional "qf" parameter for geo-bounding-box: "&qf=pl_wgs84_pos_lat%3A%5B45%20TO%2047%5D%20AND%20pl_wgs84_pos_long%3A%5B7%20TO%208%5D"
    icon:                   '<img class="datasource-icon" alt="Europeana datasource" src="/assets/icons/europeana.svg" alt="Europeana logo">',
    icon_invert:            true,
    color:                  '#0a72cc',
    display_url:            'https://www.europeana.eu/${language}/item${gid}',
    code_autocomplete:      'autocompleteEuropeana( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsEuropeana( topicResults, struct, index ) );',
    code_resolve:           'resolveEuropeana( result, renderObject )',
    code_render_mark:       'renderMarkEuropeana( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.europeana.endpoint}/entity/suggest?wskey=4ZViVZKMe&text=${term}&media=true&sort=${ valid( sortby )? sortby : "score+desc" }&rows=${datasources.europeana.autocomplete_limit}&type=&scope=europeana&language=${explore.language}',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'rijksmuseum': {
    active:                 false,
    name:                   'Rijksmuseum',
    set:                    'culture',
    description:            '🇳🇱 museum image library',
    tag:                    'arts-culture',
    qid:                    'Q190804',
    protocol:               'rest',
    endpoint:               'https://www.rijksmuseum.nl/api', // see: https://data.rijksmuseum.nl/object-metadata/api/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'relevance',
                              'relevance-desc'  : 'relevance',
                              'relevance-asc'   : 'relevance',
                              'date-desc'       : 'achronologic',
                              'date-asc'        : 'chronologic',
                              'update-desc'     : 'achronologic',
                              'update-asc'      : 'chronologic',
                              'random'          : 'objecttype',
                              'citations-desc'  : 'relevance',
                              'citations-asc'   : 'relevance',
                              'title-desc'      : 'relevance', // 'artist', // note: not quite the same
                              'title-asc'       : 'relevance', // 'artistdesc', // note: not quite the same
                              'distance-desc'   : 'relevance',
                              'distance-asc'    : 'relevance',
                            },
    media:                  [ 'image' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '', // many sub-types: painting, ...
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.rijksmuseum.endpoint}/${ selectLanguageFrom( ["nl", "en"], "en" ) }/collection?key=8MT2OLE3&imgonly=true&s=${ valid( sortby )? sortby : "relevance" }&p=${explore.page}&ps=${datasources.rijksmuseum.pagesize}&culture=${ selectLanguageFrom( ["nl", "en"], "en" ) }&q=${ removebracesTitle(term) }${ valid( [ datemin, datemax ] )? "&f.dating.period=" + Math.ceil( datemin.split("-")[0] / 100 ) : "" }',
    icon:                   '<img class="datasource-icon" alt="Rijksmuseum datasource" src="/assets/icons/rijksmuseum.svg" alt="Rijksmuseum logo">',
    icon_invert:            true,
    color:                  '#07c8f9',
    display_url:            'https://www.rijksmuseum.nl/${ selectLanguageFrom( ["nl", "en"], "en" ) }/${ valid ( explore.language === "nl" )? "collectie" : "collection" }/${gid}',
    code_autocomplete:      'autocompleteRijksmuseum( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsRijksmuseum( topicResults, struct, index ) );',
    code_resolve:           'resolveRijksmuseum( result, renderObject )',
    code_render_mark:       'renderMarkRijksmuseum( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.rijksmuseum.endpoint}/${ selectLanguageFrom( ["nl", "en"], "en" ) }/collection?key=8MT2OLE3&imgonly=true&s=${ valid( sortby )? sortby : "relevance" }&p=1&ps=${datasources.rijksmuseum.autocomplete_limit}&culture=${ selectLanguageFrom( ["nl", "en"], "en" ) }&q=${ removebracesTitle(term) }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'harvard': {
    active:                 false,
    name:                   'Harvard Art Museums',
    set:                    'culture',
    description:            '🇺🇸 art museums at Harvard University - BETA',
    tag:                    'arts-culture',
    qid:                    'Q3783572',
    protocol:               'rest',
    endpoint:               'https://api.harvardartmuseums.org/object', // see: https://github.com/harvardartmuseums/api-docs
                                                                        //      https://github.com/harvardartmuseums/api-docs/blob/master/sections/object.md
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'datebegin',
                              'date-asc'        : 'datebegin',
                              'update-desc'     : 'accessionyear',
                              'update-asc'      : 'accessionyear',
                              'random'          : 'random',
                              'citations-desc'  : 'rank',
                              'citations-asc'   : 'rank',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'image' ], // TODO
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.harvard.endpoint}/?q=${term}&size=${datasources.harvard.pagesize}&page=${explore.page}&sort=${ valid( sortby )? sortby : "" }&sortorder=${ getSortDirection( source, "short" ) }&apikey=1a89f5c0-b799-4acf-9706-f3320bcc58a6',
    icon:                   '<img class="datasource-icon" alt="Harvard Art Museums datasource" src="/assets/icons/harvard.svg" alt="Harvard Art Museums logo">',
    icon_invert:            true,
    color:                  '#07c8f9',
    display_url:            '',
    code_autocomplete:      'autocompleteHarvard( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsHarvard( topicResults, struct, index ) );',
    code_resolve:           'resolveHarvard( result, renderObject )',
    code_render_mark:       'renderMarkHaravard( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.harvard.endpoint}/?q=${term}&size=${datasources.harvard.autocomplete_limit}&page=1&sort=${ valid( sortby )? sortby : "" }&sortorder=${ getSortDirection( source, "short" ) }&apikey=1a89f5c0-b799-4acf-9706-f3320bcc58a6',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'loc': {
    active:                 false,
    name:                   'Library of Congress',
    set:                    'culture',
    description:            '🇺🇸 national library - BETA',
    tag:                    'arts-culture',
    qid:                    'Q131454',
    protocol:               'rest',
    endpoint:               'https://www.loc.gov/items/', // see: https://www.loc.gov/apis/json-and-yaml/requests/endpoints/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'date_desc',
                              'date-asc'        : 'date',
                              'update-desc'     : 'date_desc',
                              'update-asc'      : 'date',
                              'random'          : 'shelf_id',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : 'title_s_desc',
                              'title-asc'       : 'title_s',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text', 'image', 'video', 'audio', '3D', 'software' ],
                            /* TODO: filter mapping
                                - https://www.loc.gov/apis/json-and-yaml/requests/endpoints/
                                - see: https://www.loc.gov/search/?fa=partof:motion+picture,+broadcasting+%26+recorded+sound+division
                                - fa=original-format:<photo,%20print,%20drawing|book|periodical|web%20page|newspaper|map>
                            */
    filter_map:             {
                              'none'            : '',
                              'text'            : 'book', // book|periodical|web%20page|newspaper
                              'image'           : 'photo,%20print,%20drawing', // photo,%20print,%20drawing|map
                              'video'           : 'film,%20video', // film,%20video
                              'audio'           : 'sound%20recording', // sound%20recording
                              'data'            : '',
                              '3D'              : '3d%20object', // 3d%20object
                              'software'        : 'software,+e-resource', // software,+e-resource
                              'archive'         : '', // manuscript/mixed+material
                              'entity'          : '',
                                                      // personal+narrative
                            },
    url:                    '${datasources.loc.endpoint}?sp=${ explore.page }&c=${ datasources.loc.pagesize }&q=${ term }&${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "fa=original-format:" + filterby : "" }&sb=${ valid( sortby )? sortby : "" }&fo=json', 
    icon:                   '<img class="datasource-icon" alt="US Library of Congress datasource" src="/assets/icons/loc.svg" alt="US Library of Congress logo">',
    icon_invert:            true,
    color:                  '#F05129',
    display_url:            '',
    code_autocomplete:      'autocompleteLoC( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsLoC( topicResults, struct, index ) );',
    code_resolve:           'resolveLoC( result, renderObject )',
    code_render_mark:       'renderMarkLoC( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.loc.endpoint}?sp=1&c=${ datasources.loc.autocomplete_limit }&q=${ term }&fo=json', 
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'dpla': {
    active:                 false,
    name:                   'Digital Public Library of America',
    set:                    'culture',
    description:            '🇺🇸 library network - BETA',
    tag:                    'arts-culture',
    qid:                    'Q2944483',
    protocol:               'rest',
    endpoint:               'https://api.dp.la/v2/items', // see: https://pro.dp.la/developers/requests
                                                          //      https://pro.dp.la/developers/object-structure
                                                          //      https://pro.dp.la/developers/field-reference#sourceResource-spatial TODO
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // https://pro.dp.la/developers/requests#sortable
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'sourceResource.date.end',
                              'date-asc'        : 'sourceResource.date.begin',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : 'id',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : 'sourceResource.title',
                              'title-asc'       : 'sourceResource.title',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text', 'image', 'video', 'audio', '3D', 'software' ],
    filter_map:             { // sourceResource.format="Lithograph+on+paper"
                              'none'            : '',
                              'text'            : 'text',
                              'image'           : 'image',
                              'video'           : 'moving+image',
                              'audio'           : 'sound',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    'https://${explore.host}${explore.base}/app/cors/raw/?url=${ encodeURIComponent( datasources.dpla.endpoint ) }%3Fq=${ encodeURIComponent( term ) }%26sourceResource.language.name=${ explore.language_name }%26page_size=${ datasources.dpla.pagesize }%26page=${ explore.page }%26${ valid( filterby ) && Object.values( d.filter_map ).includes( filterby ) ? "sourceResource.type=" + filterby : "" }%26sort_by=${ valid( sortby )? sortby : "" }%26sort_order=${ getSortDirection( source, "short" ) }%26${ valid( [ datemin, datemax ] )? "%26sourceResource.date.after=" + datemin.split("T")[0] + "%26sourceResource.date.before=" + datemax.split("T")[0] : "" }%26api_key=5da031c24e1d76c95e3d69f27ea5a875',
    icon:                   '<img class="datasource-icon" alt="Digital Public Library of America datasource" src="/assets/icons/dpla.svg" alt="Digital Public Library of America logo">',
    icon_invert:            false,
    color:                  '#F05129',
    display_url:            '',
    code_autocomplete:      'autocompleteDPLA( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsDPLA( topicResults, struct, index ) );',
    code_resolve:           'resolveDPLA( result, renderObject )',
    code_render_mark:       'renderMarkDPLA( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       'https://${explore.host}${explore.base}/app/cors/raw/?url=${ encodeURIComponent( datasources.dpla.endpoint ) }%3Fq=${ encodeURIComponent( term ) }%26page_size=${ datasources.dpla.autocomplete_limit }%26page=1%26sort_by=${ valid( sortby )? sortby : "" }%26sort_order=${ getSortDirection( source, "short" ) }%26${ valid( [ datemin, datemax ] )? "%26sourceResource.date.after=" + datemin.split("T")[0] + "%26sourceResource.date.before=" + datemax.split("T")[0] : "" }%26api_key=5da031c24e1d76c95e3d69f27ea5a875',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'smithsonian': {
    active:                 false,
    name:                   'Smithsonian',
    set:                    'culture',
    description:            '🇺🇸 museum collection - BETA',
    tag:                    'arts-culture',
    qid:                    'Q131626',
    protocol:               'rest',
    endpoint:               'https://api.si.edu/openaccess/api/v1.0/search', // see: https://edan.si.edu/openaccess/apidocs/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : 'relevancy',
                              'relevance-asc'   : 'relevancy',
                              'date-desc'       : 'newest',
                              'date-asc'        : 'newest',
                              'update-desc'     : 'updated',
                              'update-asc'      : 'updated',
                              'random'          : 'random',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text', 'image', 'video', 'audio', '3D' ],
    filter_map:             { // edanmdm, ead_collection, ead_component, all
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.smithsonian.endpoint}?q=${ term }&rows=${ datasources.smithsonian.pagesize }&start=${ ( ( explore.page - 1) * datasources.smithsonian.pagesize ) }&sort=${ valid( sortby )? sortby : "relevancy" }&api_key=${ "jWNRrR9oQ2V4mzj5cDdldlYSZbQs3tG22f8aqZTJ" }',
    icon:                   '<img class="datasource-icon" alt="Smithsonian datasource" src="/assets/icons/smithsonian.svg" alt="Smithsonian logo">',
    icon_invert:            false,
    color:                  '#F0B323',
    display_url:            '',
    code_autocomplete:      'autocompleteSmithsonian( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsSmithsonian( topicResults, struct, index ) );',
    code_resolve:           'resolveSmithsonian( result, renderObject )',
    code_render_mark:       'renderMarkSmithsonian( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.smithsonian.endpoint}?q=${ term }&rows=${ datasources.smithsonian.autocomplete_limit }&start=0&api_key=${ "jWNRrR9oQ2V4mzj5cDdldlYSZbQs3tG22f8aqZTJ" }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  /*
  'smithsonian3D': {
    active:                 false,
    name:                   'Smithsonian 3D',
    set:                    'culture',
    description:            '🇺🇸 physical object scans - BETA',
    tag:                    'arts-culture',
    qid:                    'Q131626',
    protocol:               'rest',
    endpoint:               'https://3d-api.si.edu/api/v1.0/content/file/search', // see: https://3d-api.si.edu/api-docs/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ '3D' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
                            // FIXME: &q=mandible AND how to specify more than one file format?
    url:                    '${datasources.smithsonian3D.endpoint}?q=%22${term.replace( /"/gm, "" )}%22&model_type=gltf&rows=${datasources.smithsonian3D.pagesize}&start=${ (explore.page 0) * datasources.smithsonian3D.pagesize }',
    icon:                   '<img class="datasource-icon" alt="Smithsonian 3D datasource" src="/assets/icons/smithsonian3D.svg" alt="Smithsonian logo">',
    icon_invert:            false,
    color:                  '#F0B323',
    display_url:            'https://${explore.host}${explore.base}/app/3D/#model=${ encodeURIComponent( url )}',
    code_autocomplete:      'autocompleteSmithsonian3D( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsSmithsonian3D( topicResults, struct, index ) );',
    code_resolve:           'resolveSmithsonian3D( result, renderObject )',
    code_render_mark:       'renderMarkSmithsonian3D( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.smithsonian3D.endpoint}?q=${term}&model_type=gltf&rows=${datasources.smithsonian3D.autocomplete_limit}&start=0',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

  /*
  'met': {
    active:                 false,
    name:                   'Metropolitan Museum of Art',
    set:                    'culture',
    description:            '🇺🇸 art museum - BETA',
    tag:                    'arts-culture',
    qid:                    'Q160236',
    protocol:               'rest',
    endpoint:               'https://collectionapi.metmuseum.org/public/collection/v1/search', // see: https://metmuseum.github.io/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : 'relevance',
                              'date-desc'       : 'achronologic',
                              'date-asc'        : 'chronologic',
                              'update-desc'     : 'achronologic',
                              'update-asc'      : 'chronologic',
                              'random'          : 'objecttype',
                              'citations-desc'  : 'relevance',
                              'citations-asc'   : 'relevance',
                              'title-desc'      : 'relevance',
                              'title-asc'       : 'relevance',
                              'distance-desc'   : 'relevance',
                              'distance-asc'    : 'relevance',
                            },
    media:                  [ 'image' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '', // many sub-types: painting, ...
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
                            // hasImages=true
    url:                    '${datasources.met.endpoint}/?hasImages=true&q=${ term }'
    // ${ selectLanguageFrom( ["nl", "en"], "en" ) }/collection?key=8MT2OLE3&imgonly=true&s=${ valid( sortby )? sortby : "relevance" }&p=${explore.page}&ps=${datasources.rijksmuseum.pagesize}&culture=${ selectLanguageFrom( ["nl", "en"], "en" ) }&q=${ removebracesTitle(term) }',
    icon:                   '<img class="datasource-icon" alt="Rijksmuseum datasource" src="/assets/icons/rijksmuseum.svg" alt="Rijksmuseum logo">',
    icon_invert:            true,
    color:                  '#07c8f9',
    display_url:            'https://www.rijksmuseum.nl/${ selectLanguageFrom( ["nl", "en"], "en" ) }/${ valid ( explore.language === "nl" )? "collectie" : "collection" }/${gid}',
    code_autocomplete:      'autocompleteRijksmuseum( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsRijksmuseum( topicResults, struct, index ) );',
    code_resolve:           'resolveRijksmuseum( result, renderObject )',
    code_render_mark:       'renderMarkRijksmuseum( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.rijksmuseum.endpoint}/${ selectLanguageFrom( ["nl", "en"], "en" ) }/collection?key=8MT2OLE3&imgonly=true&s=${ valid( sortby )? sortby : "relevance" }&p=1&ps=${datasources.rijksmuseum.autocomplete_limit}&culture=${ selectLanguageFrom( ["nl", "en"], "en" ) }&q=${ removebracesTitle(term) }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

  'openalex': {
    active:                 false,
    name:                   'OpenAlex',
    set:                    'science',
    description:            'science articles',
    tag:                    'science',
    qid:                    'Q107507571',
    protocol:               'rest',
    endpoint:               'https://api.openalex.org/works', // see: https://docs.openalex.org/how-to-use-the-api/api-overview
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'relevance_score:desc',
                              'relevance-desc'  : 'relevance_score:desc',
                              'relevance-asc'   : 'cited_by_count:asc', // Note: "OpenAlex: Sorting relevance score ascending is not allowed."
                              'date-desc'       : 'publication_date:desc',
                              'date-asc'        : 'publication_date:asc',
                              'update-desc'     : 'publication_date:desc',
                              'update-asc'      : 'publication_date:asc',
                              'random'          : 'display_name',
                              'citations-desc'  : 'cited_by_count:desc',
                              'citations-asc'   : 'cited_by_count:asc',
                              'title-desc'      : 'display_name:desc',
                              'title-asc'       : 'display_name:asc',
                              'distance-desc'   : 'relevance_score:desc',
                              'distance-asc'    : 'relevance_score:desc',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.openalex.endpoint}?filter=default.search:${term},language:languages/${explore.language}|languages/en${ valid( geofilter_country ) ? ",authorships.countries%3Acountries%2F" + geofilter_country : "" }&sort=${ valid( sortby )? sortby : "relevance_score:desc" }&page=${explore.page}&per-page=${datasources.openalex.pagesize}',
    icon:                   '<img class="datasource-icon" alt="OpenAlex logo" src="/assets/icons/openalex.svg" alt="OpenAlex logo">',
    icon_invert:            true,
    color:                  '#cbdff7',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteOpenAlex( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsOpenAlex( topicResults, struct, index ) );',
    code_resolve:           'resolveOpenAlex( result, renderObject )',
    code_render_mark:       'renderMarkOpenAlex( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.openalex.endpoint}?filter=default.search:${term},language:languages/${explore.language}|languages/en${ valid( geofilter_country ) ? ",authorships.countries%3Acountries%2F" + geofilter_country : "" }&sort=${ valid( sortby )? sortby : "relevance_score:desc" }&page=1&per-page=${datasources.openalex.autocomplete_limit}',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'arxiv': {
    active:                 false,
    name:                   'arXiv',
    set:                    'science',
    description:            'science articles',
    tag:                    'science',
    qid:                    'Q118398',
    protocol:               'rest',
    endpoint:               'https://export.arxiv.org/api/query', // see: https://info.arxiv.org/help/api/user-manual.html
    format:                 'json',
    connect:                'xml',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'relevance',
                              'relevance-desc'  : 'relevance',
                              'relevance-asc'   : 'relevance',
                              'date-desc'       : 'submittedDate',
                              'date-asc'        : 'submittedDate',
                              'update-desc'     : 'lastUpdatedDate',
                              'update-asc'      : 'lastUpdatedDate',
                              'random'          : 'relevance',
                              'citations-desc'  : 'relevance',
                              'citations-asc'   : 'relevance',
                              'title-desc'      : 'relevance',
                              'title-asc'       : 'relevance',
                              'distance-desc'   : 'relevance',
                              'distance-asc'    : 'relevance',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.arxiv.endpoint}?search_query=all:${term}&sortBy=${ valid( sortby )? sortby : "relevance" }&sortOrder=${ getSortDirection( source ) }&start=${ ( explore.page - 1) * datasources.arxiv.pagesize }&max_results=${datasources.arxiv.pagesize}',
    icon:                   '<img class="datasource-icon" alt="arXiv logo" src="/assets/icons/arxiv.svg" alt="arXiv logo">',
    icon_invert:            false,
    color:                  '#b31b1b',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteArxiv( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsArxiv( topicResults, struct, index ) );',
    code_resolve:           'resolveArxiv( result, renderObject )',
    code_render_mark:       'renderMarkArxiv( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.arxiv.endpoint}?search_query=all:${term}&sortBy=${ valid( sortby )? sortby : "relevance" }&sortOrder=${ getSortDirection( source ) }&start=0&max_results=${datasources.arxiv.autocomplete_limit}',
    autocomplete_format:    'json',
    autocomplete_connect:   'xml',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'doaj': {
    active:                 false,
    name:                   'DOAJ journals',
    set:                    'science',
    description:            'Directory of Open Access Journals - BETA',
    tag:                    'science',
    qid:                    'Q1227538',
    protocol:               'rest',
                            // TODO add "geofilter -> country-iso2 -> country-param
    endpoint:               'https://doaj.org/api/search/journals/', // see: https://doaj.org/api/v3/docs#!/Search/get_api_search_journals_search_query
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : 'issn:desc',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : 'title:desc',
                              'title-asc'       : 'title:asc',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'entity' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.doaj.endpoint}/${term}?page=${ explore.page }&pageSize=${ datasources.doaj.pagesize }&${ valid( sortby )? "sort=" + sortby : "" }',
    icon:                   '<img class="datasource-icon" alt="Directory of Open Access Journals" src="/assets/icons/doaj.svg" alt="Directory of Open Access Journals">',
    icon_invert:            true,
    color:                  '#982e0a',
    display_url:            '',
    code_autocomplete:      'autocompleteDOAJ( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsDOAJ( topicResults, struct, index ) );',
    code_resolve:           'resolveDOAJ( result, renderObject )',
    code_render_mark:       'renderMarkDOAJ( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.doaj.endpoint}/${term}?page=1&pageSize=${ datasources.doaj.pagesize }&${ valid( sortby )? "sort=" + sortby : "" }',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  /*
  'archive_scholar': {
    active:                 false,
    name:                   'Internet Archive Scholar',
    set:                    'science',
    description:            'science articles',
    tag:                    'science',
    qid:                    'Q115667709',
    protocol:               'rest',
    endpoint:               'https://scholar.archive.org', // see: https://scholar.archive.org/api/redoc
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'relevancy',
                              'relevance-desc'  : 'relevancy',
                              'relevance-asc'   : 'relevancy',
                              'date-desc'       : 'time_desc',
                              'date-asc'        : 'time_asc',
                              'update-desc'     : 'time_desc',
                              'update-asc'      : 'time_asc',
                              'random'          : 'time_asc',
                              'citations-desc'  : 'relevancy',
                              'citations-asc'   : 'relevancy',
                              'title-desc'      : 'relevancy',
                              'title-asc'       : 'relevancy',
                              'distance-desc'   : 'relevancy',
                              'distance-asc'    : 'relevancy',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.archive_scholar.endpoint}/search?sort_order=${ valid( sortby )? sortby : "relevancy" }&limit=${datasources.archive_scholar.pagesize}&offset=${ (explore.page -1) * datasources.archive_scholar.pagesize }&q=lang%3A${language}+${term}',
    icon:                   '<img class="datasource-icon" alt="Internet Archive Scholar datasource" src="/assets/icons/archive_scholar.svg" alt="Internet Archive Scholar logo">',
    icon_invert:            true,
    color:                  '#44a25a',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteArchiveScholar( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsArchiveScholar( topicResults, struct, index ) );',
    code_resolve:           'resolveArchiveScholar( result, renderObject )',
    code_render_mark:       'renderMarkArchiveScholar( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    false, // Note: It seems this API is too rate-limited to allow autocompletion-requests
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.archive_scholar.endpoint}/search?sort_order=${ valid( sortby )? sortby : "relevancy" }&limit=${datasources.archive_scholar.pagesize}&offset=0&q=lang%3A${language}+"${term}"',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

  'gbif': {
    active:                 false,
    name:                   'GBIF species',
    set:                    'science',
    description:            'species observations - BETA',
    tag:                    'science',
    qid:                    'Q1531570',
    protocol:               'rest',
    endpoint:               'https://api.gbif.org/v1/species', // see: https://www.gbif.org/developer/species
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.gbif.endpoint}/search?verbose=true&rank=species&q=${term}&limit=${datasources.gbif.pagesize}&offset=${ (explore.page -1) * datasources.gbif.pagesize }&rank=SPECIES&isExtinct=false',
    icon:                   '<img class="datasource-icon" alt="GBIF datasource" src="/assets/icons/gbif.png" alt="GBIF logo">',
    icon_invert:            false,
    color:                  '#78b578',
    display_url:            'https://${explore.host}${explore.base}/app/response/gbif-map.php?l=${explore.language}&t=${title}&id=${gid}',
    code_autocomplete:      'autocompleteGBIF( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsGBIF( topicResults, struct, index ) );',
    code_resolve:           'resolveGBIF( result, renderObject )',
    code_render_mark:       'renderMarkGBIF( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.gbif.endpoint}/suggest?q=${term}&limit=${datasources.gbif.autocomplete_limit}&offset=0&rank=SPECIES&isExtinct=false',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  // re-enable once API-support for page-sizing is working
  /*
  'ror': {
    active:                 false,
    name:                   'ROR research organizations',
    set:                    '', // science (too many results returned currently, only set once the page-size-parameter is available)
    description:            'research organizations',
    tag:                    'organization',
    qid:                    'Q110235640',
    protocol:               'rest',
    endpoint:               'https://api.ror.org/v2/organizations', // see: https://ror.readme.io/v2/docs/api-list
                                                                    //      https://ror.readme.io/v2/docs/data-structure
                                                                    //      https://ror.org/events/2023-02-01-intro-ror-api/
    format:                 'json',
    connect:                'json',
    pagesize:               20, // TOWAIT: no page-size parameter in the RoR API yet! Github issue: ...
                                // https://github.com/ror-community/ror-api/issues/50
    //pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // 
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'entity' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.ror.endpoint}?query=${term}&page=${explore.page}',
    icon:                   '<img class="datasource-icon" alt="ROR datasource" src="/assets/icons/ror.svg" alt="ROR logo">',
    icon_invert:            true,
    color:                  '#53baa1',
    display_url:            'https://ror.org/${gid}',
    code_autocomplete:      'autocompleteROR( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsROR( topicResults, struct, index ) );',
    code_resolve:           'resolveROR( result, renderObject )',
    code_render_mark:       'renderMarkROR( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.ror.endpoint}?query=${term}&page=1',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     20, // TOWAIT: for API page-size support
  },
  */

  'gleif': {
    active:                 false,
    name:                   'GLEIF legal entities',
    set:                    'business',
    description:            'legal entities',
    tag:                    'business',
    qid:                    'Q6517388',
    protocol:               'rest',
    endpoint:               'https://api.gleif.org/api/v1/lei-records', // see: https://documenter.getpostman.com/view/7679680/SVYrrxuU?version=latest
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               { // MAYBE TODO: see sortable field: https://api.gleif.org/api/v1/fields the use as: "sort=entity.legalName"
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'entity' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.gleif.endpoint}?page[size]=${datasources.gleif.pagesize}&page[number]=${explore.page}&filter[fulltext]=${term}&${ valid( geofilter_country ) ? "filter%5Bentity.legalAddress.country%5D=" + geofilter_country : "" }',
    icon:                   '<img class="datasource-icon" alt="GLEIF datasource" src="/assets/icons/gleif.svg" alt="Gleif logo">',
    icon_invert:            false,
    color:                  '#51dac5',
    display_url:            'https://www.lei-lookup.com/record/${gid}/',
    code_autocomplete:      'autocompleteGleif( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsGleif( topicResults, struct, index ) );',
    code_resolve:           'resolveGleif( result, renderObject )',
    code_render_mark:       'renderMarkGleif( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.gleif.endpoint}?page[size]=${datasources.gleif.autocomplete_limit}&page[number]=1&filter[fulltext]=${term}',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'eu': {
    active:                 false,
    name:                   'European Union data',
    set:                    'business',
    tag:                    'government',
    description:            '🇪🇺 European Union datasets - BETA',
    qid:                    'Q458',
    protocol:               'rest',
    endpoint:               'https://data.europa.eu/api/hub/search/search', // see: https://data.europa.eu/api/hub/search/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : 'relevance%2Bdesc',
                              'relevance-desc'  : 'relevance%2Bdesc',
                              'relevance-asc'   : 'relevance%2Basc',
                              'date-desc'       : 'issued%2Bdesc',
                              'date-asc'        : 'issued%2Basc',
                              'update-desc'     : 'modified%2Bdesc',
                              'update-asc'      : 'modified%2Basc',
                              'random'          : 'identifier%2Bdesc',
                              'citations-desc'  : 'is_referenced_by%2Bdesc',
                              'citations-asc'   : 'is_referenced_by%2Basc',
                              'title-desc'      : 'title.en%2Bdesc',
                              'title-asc'       : 'title.en%2Basc',
                              'distance-desc'   : 'relevance%2Bdesc',
                              'distance-asc'    : 'relevance%2Bdesc',
                            },
    media:                  [ 'data' ], //  "dataset", "catalogue", "dataservice", "vocabulary", "resource"
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.eu.endpoint}?q=${term}&filter=dataset&limit=${datasources.eu.pagesize}&page=${explore.page - 1}&sort=${ valid( sortby )? sortby : "relevance%2Bdesc" },+modified%2Bdesc,+title.en%2Basc&facetOperator=AND&facetGroupOperator=AND&dataServices=false&facets={"publisher":[],"format":[],"catalog":[],"categories":[],"keywords":[],"country":[],"license":[]}',
    icon:                   '<img class="datasource-icon" alt="European Union datasource" src="/assets/icons/eu.svg" alt="EU flag">',
    icon_invert:            false,
    color:                  '#082b7a',
    display_url:            'https://data.europa.eu/data/datasets/${gid}?locale=${ selectLanguageFrom( ["en","nl","es","de","it","fr"], "en" ) }',
    code_autocomplete:      'autocompleteEU( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsEU( topicResults, struct, index ) );',
    code_resolve:           'resolveEU( result, renderObject )',
    code_render_mark:       'renderMarkEU( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.eu.endpoint}?q=${term}&filter=dataset&limit=${datasources.eu.autocomplete_limit}&page=0&sort=${ valid( sortby )? sortby : "relevance%2Bdesc" },+modified%2Bdesc,+title.en%2Basc&facetOperator=AND&facetGroupOperator=AND&dataServices=false&facets={"publisher":[],"format":[],"catalog":[],"categories":[],"keywords":[],"country":[],"license":[]}',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'gdelt': {
    active:                 false,
    name:                   'GDELT news',
    set:                    'business',
    description:            'news reports - BETA',
    tag:                    'work',
    qid:                    'Q18357239',
    protocol:               'rest',
    endpoint:               'https://api.gdeltproject.org/api/v2/context/context', // see: https://blog.gdeltproject.org/announcing-the-gdelt-context-2-0-api/
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : 'DateDesc',
                              'date-asc'        : 'DateAsc',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'text' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.gdelt.endpoint}?format=html&timespan=2D&query=${ encodeURIComponent( term ) }&searchlang=${explore.language_name}&mode=artlist&maxrecords=5&format=json',
    icon:                   '<img class="datasource-icon" alt="GDELT logo" src="/assets/icons/gdelt.svg" alt="GDELT logo">',
    icon_invert:            true,
    color:                  '#fb7b10',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteGDELT( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsGDELT( topicResults, struct, index ) );',
    code_resolve:           'resolveGDELT( result, renderObject )',
    code_render_mark:       'renderMarkGDELT( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    false,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.gdelt.endpoint}?format=html&timespan=2D&query=${ encodeURIComponent( term ) }&searchlang=${explore.language_name}&mode=artlist&maxrecords=${datasources.gdelt.autocomplete_limit}&format=json',

    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  'occrp': {
    active:                 false,
    name:                   'OCCRP entities',
    set:                    'business',
    description:            'investigative journalism entities - BETA',
    tag:                    'science',
    qid:                    'Q7102061',
    protocol:               'rest',
                              // see:
                              //  https://redocly.github.io/redoc/?url=https://aleph.occrp.org/api/openapi.json#tag/Entity
                              //  https://docs.aleph.occrp.org/developers/followthemoney/
    endpoint:               'https://aleph.occrp.org/api/2/entities',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'entity' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.occrp.endpoint}?q=${term}&page=${explore.page}&limit=${datasources.occrp.pagesize}&filter:schemata=Thing',
    icon:                   '<img class="datasource-icon" alt="OCCRP logo" src="/assets/icons/occrp.svg" alt="OCCRP logo">',
    icon_invert:            false,
    color:                  '#982022',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteOCCRP( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsOCCRP( topicResults, struct, index ) );',
    code_resolve:           'resolveOCCRP( result, renderObject )',
    code_render_mark:       'renderMarkOCCRP( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.occrp.endpoint}?q=${term}&page=1&limit=${datasources.occrp.autocomplete_limit}&filter:schemata=Thing',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },

  /*
  'marginalia': {
    active:                 false,
    name:                   'Marginalia',
    set:                    'web',
    description:            'web search engine - BETA',
    tag:                    'web',
    qid:                    '',
    protocol:               'rest',
                              // see:
                              //  https://www.marginalia.nu/marginalia-search/api/
                              //  https://api.marginalia.nu/public/search/water?index=0&count=10
    endpoint:               'https://api.marginalia.nu/public/search/',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    media:                  [ 'entity' ],
    filter_map:             {
                              'none'            : '',
                              'text'            : '',
                              'image'           : '',
                              'video'           : '',
                              'audio'           : '',
                              'data'            : '',
                              '3D'              : '',
                              'software'        : '',
                              'archive'         : '',
                              'entity'          : '',
                            },
    url:                    '${datasources.occrp.endpoint}?q=${term}&page=${explore.page}&limit=${datasources.occrp.pagesize}&filter:schemata=Thing',
    icon:                   '<img class="datasource-icon" alt="OCCRP logo" src="/assets/icons/occrp.svg" alt="OCCRP logo">',
    icon_invert:            false,
    color:                  '#982022',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteOCCRP( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsOCCRP( topicResults, struct, index ) );',
    code_resolve:           'resolveOCCRP( result, renderObject )',
    code_render_mark:       'renderMarkOCCRP( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.occrp.endpoint}?q=${term}&page=1&limit=${datasources.occrp.autocomplete_limit}&filter:schemata=Thing',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

  /*
  'inaturalist': {
    active:                 false,
    set:                    'science',
    name:                   'iNaturalist',
    description:            'taxon observations - BETA',
    tag:                    'science',
    qid:                    'Q16958215',
    protocol:               'rest',
    endpoint:               'https://api.inaturalist.org/v1/taxa', // see: https://api.inaturalist.org/v1/docs/#!/Taxa/get_taxa
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    url:                    '${datasources.inaturalist.endpoint}?q=${term}&order=desc&page=${explore.page}&per_page=${datasources.inaturalist.pagesize}',
    icon:                   '<img class="datasource-icon" alt="iNaturalist logo" src="/assets/icons/inaturalist.svg" alt="iNaturalist logo">',
    icon_invert:            false,
    color:                  '#982022',
    display_url:            '${url}',
    code_autocomplete:      'autocompleteInaturalist( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsInaturalist( topicResults, struct, index ) );',
    code_resolve:           'resolveInaturalist( result, renderObject )',
    code_render_mark:       'renderMarkInaturalist( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.inaturalist.endpoint}?q=${term}&order=desc&page=1&per_page=${datasources.inaturalist.autocomplete_limit}',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

  /*
  'rkd': {
    active:                 false,
    name:                   'RKD',
    set:                    'culture',
    description:            '🇳🇱 art-history library - FAILING',
    tag:                    'arts-culture',
    qid:                    'Q758610',
    protocol:               'rest',
    // see: https://api.rkd.nl/api
    //endpoint:             'https://api.rkd.nl/api/instant/images',
    endpoint:               '/app/proxy/rkd',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    url:                    '${datasources.rkd.endpoint}?query=${term}&format=json&rows=${datasources.rkd.pagesize}&start=${ (explore.page -1) * datasources.rkd.pagesize }',
    //url:                    '${datasources.rkd.endpoint}?query=${term}&format=json&rows=${datasources.rkd.pagesize}&start=${ (explore.page -1) * datasources.rkd.pagesize }',
    icon:                   '<img class="datasource-icon" alt="RKD datasource" src="/assets/icons/rkd.svg" alt="RKD logo">',
    icon_invert:            false,
    color:                  '#982022',
    display_url:            '',
    code_autocomplete:      'autocompleteRKD( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsRKD( topicResults, struct, index ) );',
    code_resolve:           'resolveRKD( result, renderObject )',
    code_render_mark:       'renderMarkRKD( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.rkd.endpoint}?query=${term}&format=json&rows=${datasources.rkd.autocomplete_limit}&start=0',
    //autocomplete_url:       '${datasources.rkd.endpoint}?query=${term}&format=json&rows=${datasources.rkd.autocomplete_limit}&start=0',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */


  /*
  'snomed': {
    active:                 false,
    name:                   'SNOMED CT',
    set:                    'science',
    description:            'medical ontology',
    tag:                    'science',
    qid:                    'Q1753883',
    protocol:               'rest',
    endpoint:               'https://browser.ihtsdotools.org/snowstorm/snomed-ct/browser/MAIN/2023-04-30/descriptions',
    format:                 'json',
    connect:                'json',
    pagesize:               `${explore.datasource_page_size}`,
    sort_map:               {
                              'none'            : '',
                              'relevance-desc'  : '',
                              'relevance-asc'   : '',
                              'date-desc'       : '',
                              'date-asc'        : '',
                              'update-desc'     : '',
                              'update-asc'      : '',
                              'random'          : '',
                              'citations-desc'  : '',
                              'citations-asc'   : '',
                              'title-desc'      : '',
                              'title-asc'       : '',
                              'distance-desc'   : '',
                              'distance-asc'    : '',
                            },
    url:                    '${datasources.snomed.endpoint}?&limit=${datasources.snomed.pagesize}&term=${term}&active=true&conceptActive=true&lang=english&groupByConcept=true&offset=${ (explore.page -1) * datasources.snomed.pagesize }',
    icon:                   '<img class="datasource-icon" alt="SNOMED CT datasource" src="/assets/icons/snomed.png" alt="SNOMED CT logo">',
    icon_invert:            false,
    color:                  '#982022',
    display_url:            'https://browser.ihtsdotools.org/?perspective=full&conceptId1=${gid}/',
    code_autocomplete:      'autocompleteSnomed( r, dataset )',
    code_data_collect:      'my_promises.push( processResultsSnowmed( topicResults, struct, index ) );',
    code_resolve:           'resolveSnomed( result, renderObject )',
    code_render_mark:       'renderMarkSnomed( inputs, source, q_, show_raw_results, id )',
    autocomplete_active:    true,
    autocomplete_protocol:  'json',
    autocomplete_url:       '${datasources.snomed.endpoint}?&limit=${datasources.snomed.autocomplete_limit}&term=${term}&active=true&conceptActive=true&lang=english&groupByConcept=true&offset=0',
    autocomplete_format:    'json',
    autocomplete_connect:   'json',
    autocomplete_limit:     `${explore.datasource_autocomplete_limit}`,
  },
  */

};

const d_ = Object.keys( datasources );

// Note: Update this list and the "index.template.php" datasource-set select-options when needed;
const datasource_set_map = {
  none:       [''],
  reference:  d_.filter( function( d ) { return datasources[ d ].set === 'reference'; } ),
  culture:    d_.filter( function( d ) { return datasources[ d ].set === 'culture'; } ),
  science:    d_.filter( function( d ) { return datasources[ d ].set === 'science'; } ),
  business:   d_.filter( function( d ) { return datasources[ d ].set === 'business'; } ),
}

const datasource_sets = Object.keys( datasource_set_map );

delete d_;

// add user-configured graphview styles for each datasource
let graphview_css = '';

$.each( Object.keys( datasources ), function( index, source ){

  if ( valid( datasources[source] ) ){

    let color = datasources[source].color;

    graphview_css += '.my-cy-node:has(.entry[data-source="' + source + '"]) { border: 1em solid ' + color + '; border-radius: 7em; }';

  }

});

// Note: Update this list and the "index.template.php" select-options, whenever the datasource "sort_map" structure changes.
const valid_sort_options = [
  'none',
  'relevance-desc',
  'relevance-asc',
  'date-desc',
  'date-asc',
  'update-desc',
  'update-asc',
  'random',
  'citations-desc',
  'citations-asc',
  'title-asc',
  'title-desc',
  'distance-asc',
  'distance-desc',
];

// Note: Update this list and the "index.template.php" select-options, whenever the datasource "filter_map" structure changes.
const valid_filter_options = [
  'none',
  'text',
  'image',
  'video',
  'audio',
  'data',
  '3D',
  'software',
  'archive',
  'entity',
];
