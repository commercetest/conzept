'use strict';var a=a=>typeof a=='undefined',b=angular.module('tooglesApp',['ngAnimate','ngAria','ngCookies','ngMessages','ngResource','ngRoute','ngSanitize','ngTouch']).config(['$routeProvider',function(A){A.when('/browse',{templateUrl:'views/list.html',controller:'ListCtrl'});A.when('/browse/:category',{templateUrl:'views/list.html',controller:'ListCtrl'});A.when('/search/:query',{templateUrl:'views/list.html',controller:'ListCtrl'});A.when('/view/:id',{templateUrl:'views/view.html',controller:'ViewCtrl'});A.when('/view/:id/:starttime',{templateUrl:'views/view.html',controller:'ViewCtrl'});A.when('/view/:id/:starttime/:endtime',{templateUrl:'views/view.html',controller:'ViewCtrl'});A.when('/playlist/:id',{templateUrl:'views/view.html',controller:'ViewCtrl'});A.when('/playlist/:id/:start',{templateUrl:'views/view.html',controller:'ViewCtrl'});A.when('/user/:username',{templateUrl:'views/list.html',controller:'ListCtrl'});A.when('/user/:username/:feed',{templateUrl:'views/list.html',controller:'ListCtrl'});A.otherwise({redirectTo:'/browse'})}]);b.controller('ListCtrl',['$scope','$routeParams','$location','youtube',function(_,B,C,D){_.location=C;_.routeParams=B;_.searchsort=C.search()['searchsort']||!1;_.searchduration=C.search()['searchduration']||!1;_.searchdefinition=C.search()['searchdefinition']||!1;_.searchdimension=C.search()['searchdimension']||!1;_.eventtype=C.search()['eventtype']||'completed';_.type=C.search()['type']||'video';_.searchtype=C.search()['searchtype']||'videos';_.section=C.path().split('/')[1];_.page=1;_.nextPageToken='';_.usedTokens=[];_.videos=[];_.categoryVideos=()=>{document.title='Popular | video';D.categoryVideos(_.nextPageToken,B.category,function(_a){_.nextPageToken=_a.nextPageToken;_.videos=_.videos.concat(_a.items)})};_.searchVideos=()=>{document.title=B.query+' | video';_.query=B.query;var _A={};B.searchsort&&(_A.order=B.searchsort);B.searchduration&&(_A.videoDuration=B.searchduration);B.eventtype&&(_A.eventType=B.eventtype);B.searchdimension&&(_A.videoDimension=B.searchdimension);B.type&&(_A.Type=B.type);B.searchdefinition&&(_A.videoDefinition=B.searchdefinition);D.searchVideos(_.nextPageToken,B.query,_A,function(e){_.nextPageToken=e.nextPageToken;var _b=[];angular.forEach(e.items,function(E){_b.push(E.id.videoId)});D.fetchVideos(_b,function(aA){_.videos=_.videos.concat(aA.items)})})};_.userVideos=()=>D.userData(B.username,function(aB){_.user=aB.items[0];document.title=_.user.snippet.title+' | video';D.playlistVideos(_.nextPageToken,aB.items[0].contentDetails.relatedPlaylists.uploads,function(aC){_.nextPageToken=aC.nextPageToken;var aD=[];angular.forEach(aC.items,function(aE){aD.push(aE.contentDetails.videoId)});D.fetchVideos(aD,function(aF){_.videos=_.videos.concat(aF.items)})})});_.popularVideos=()=>{document.title='Popular | video';D.popularVideos(_.nextPageToken,function(aG){_.nextPageToken=aG.nextPageToken;_.videos=_.videos.concat(aG.items)})};_.loadVideos=()=>{if(_.nextPageToken==void 0||$.inArray(_.nextPageToken,_.usedTokens)>=0&&_.nextPageToken!=='')return;_.usedTokens.push(_.nextPageToken);B.category!==void 0?_.categoryVideos():B.query!==void 0&&B.query!==''&&B.query!=='0'?_.searchVideos():B.username!==void 0?_.userVideos():_.popularVideos()};_.loadVideos();D.videoCategories(response=>_.categories=response.items);_.getLink=video=>'#/view/'+video.id;_.formatDuration=seconds=>D.formatDuration(seconds);_.averageRating=(likeCount,dislikeCount)=>D.averageRating(likeCount,dislikeCount)}]);let c='';window.addEventListener('message',d,!1);function d(aH){if(aH.data.event_id=='goto'){var aI=aH.data.data[0];c.seekTo(aI)}}b.controller('ViewCtrl',['$scope','$routeParams','$location','youtube',function(aJ,aK,_c,_d){aJ.location=_c;aJ.showSidebar=!0;aJ.showRelated=!1;aJ.section=_c.path().split('/')[1];aJ.videoTab=aJ.section=='view'?'Related':'Playlist';aJ.videos=[];_d.fetchVideos(aK.id,function(aL){aJ.video=aL.items[0];h(aJ.video.id,aJ.section);document.title=aJ.video.snippet.title+' | Toogles'});aJ.fetchRelated=()=>{aJ.showRelated=!0;_d.relatedVideos(aK.id,function(aM){var aN=[];angular.forEach(aM.items,function(aO){aN.push(aO.id.videoId)});_d.fetchVideos(aN,function(aP){aJ.videos=aP.items})})};aJ.formatDuration=seconds=>_d.formatDuration(seconds);var _e=!1,h=function(aQ,aR){var _C=aK.starttime||0,_D=aK.endtime||'';if(void 0==typeof _C||a(_C)||!_C){}else _C.includes(':')&&(_C=_C.split(':').reduce((acc,time)=>(60*acc)+ +time));if(void 0==typeof _D||a(_D)||!_D){}else _D.includes(':')&&(_D=_D.split(':').reduce((acc,time)=>(60*acc)+ +time));c=new YT.Player('player', {'videoId':aQ,'playerVars':{'autoplay':1,'theme':f,'color':g,'iv_load_policy':3,'origin':'https://conze.pt','start':_C,'end':_D},'events':{'onError':function(aS){aS.data==101||aS.data==150?aJ.video.restricted=1:aJ.video.deleted=1;aJ.$apply()},'onStateChange':function(aT){!aT.data&&(goWander=getParameterByName('wander')||!1,goWander?parent.postMessage({event_id:'next-wander-video', data:{}},'*'):parent.postMessage({event_id:'next-presentation-slide', data:{}},'*'));aT.data==1&&(_e=!0);if(_e&&aT.data==-1)if(aR=='view'){var aU=aT.target.getVideoUrl(),aV=aU.replace('http://','').replace('https://','').replace('www.youtube.com/watch?v=','').replace('&feature=player_embedded','');window.location=`#/view/${aV}`}else aR=='playlist'&&(window.location='#/playlist/'+aT.target.getPlaylistId()+'/'+aT.target.getPlaylistIndex()); else if(_e&&!aT.data&&aR=='playlist'){var aW=_c.path().split('/'),_E=aW[2],F=aW[3],F=0;aW[3];F++;window.location='#/playlist/'+_E+'/'+F}}}})};if(aJ.$parent.darkmode)var f='dark',g='black'else var f='light',g='white'aJ.getLink=video=>'#/view/'+video.id;aJ.averageRating=(likeCount,dislikeCount)=>_d.averageRating(likeCount,dislikeCount)}]);b.service('youtube',['$http',function(aX){var aY=`${CONZEPT_WEB_BASE}/app/proxy/video/`,aZ='',bA=12,bB=getParameterByName('l')||'en';this.searchVideos=function(bC,bD,bE,bF){bE&&(bG+='&'+$.param(bE));bC&&(bG+=`&pageToken=${bC}`);return this.sendRequest(aY+'search?part=id&type=video&maxResults='+bA+'&q='+bD+'&relevanceLanguage='+bB+'&xkey='+aZ,bF)};this.relatedVideos=function(bH,bI){return this.sendRequest(aY+'search?part=id&type=video&maxResults='+bA+'&relatedToVideoId='+bH+'&xkey='+aZ,bI)};this.popularVideos=function(bK,bL){bK&&(bM+=`&pageToken=${bK}`);return this.sendRequest(aY+'videos?part=statistics,snippet,contentDetails&chart=mostPopular&maxResults='+bA+'&xkey='+aZ,bL)};this.fetchVideos=function(bN,bO){$.isArray(bN)&&(bN=bN.join(','));return this.sendRequest(aY+'videos?part=statistics,snippet,contentDetails&id='+bN+'&xkey='+aZ,bO)};this.categoryVideos=function(bQ,bR,bS){bQ&&(bT+=`&pageToken=${bQ}`);return this.sendRequest(aY+'videos?part=statistics,snippet,contentDetails&chart=mostPopular&maxResults='+bA+'&videoCategoryId='+bR+'&xkey='+aZ,bS)};this.videoCategories=function(bU){return this.sendRequest(aY+'videoCategories?part=snippet&regionCode=US&xkey='+aZ,bU)};this.playlistVideos=function(bW,bX,bY){bW&&(bZ+=`&pageToken=${bW}`);return this.sendRequest(aY+'playlistItems?part=contentDetails&order=date&maxResults='+bA+'&playlistId='+bX+'&xkey='+aZ,bY)};this.userData=function(cA,cB){return this.sendRequest(aY+'channels?part=contentDetails,snippet,statistics&order=date&maxResults='+bA+'&id='+cA+'&xkey='+aZ,cB)};this.sendRequest=function(cD,cE){return aX.get(cD).success(data=>cE(data)).error(()=>{})};this.formatDuration=function(cF){var cG=/^PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?$/;var cH=0,cI=0,cJ=0;if(cG.test(cF)){var _f=cG.exec(cF),G=cH*3600+cI*60+cJ,cH=parseInt(G/3600)%24,cI=parseInt(G/60)%60,cJ=G%60,H='';_f[1]&&(cH=+_f[1]);_f[2]&&(cI=+_f[2]);_f[3]&&(cJ=+_f[3]);cH>0&&(H+=`${cH}:`);cH>0?H+=(cI<10?`0${cI}`:cI)+':':H+=`${cI}:`;H+=(cJ<10?`0${cJ}`:cJ);return H}};this.averageRating=function(cK,cL){cK=parseInt(cK);cL=parseInt(cL);var cM=cK+cL,cN=cK/cM;return cN*100}}]);b.filter('htmlify',function(){returncO=>{if(!cO)return'';var cQ=cO.replace(/(\b(https?|ftp|file):\/\/[\w!#%&+,.\/:;=?@|~-]*[\w#%&+\/=@|~-])/ig,'<a href='$1'>$1</a>');cQ=cQ.replace(/\n/g,'<br />');return cQ}});b.directive('whenScrolled',function(){return(scope,elm,attr)=>$(window).scroll(()=>$(window).scrollTop()>=$(document).height()-$(window).height()-10&&scope.$apply(attr.whenScrolled))});
